<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Elite Gamez</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/elite-gamez/elite-gamez.github.io@main/css/style.css" />
	<style>
		:root {
			--bg: #000000;
			--header-bg: rgba(255, 255, 255, 0.03);
			--text: #ffffff;
			--muted: #c4b5fd;
			--accent: #8b5cf6;
			--accent-dark: #7c3aed;
			--accent-shadow: rgba(139, 92, 246, 0.3);
			--card-bg: rgba(255, 255, 255, 0.03);
			--card-radius: 16px;
			--card-shadow: 0 0 10px var(--accent-shadow);
			--glow-size: 15px;
			--glow-strength: 0.25;
			--font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
			--snow-color: #c4b5fd;
			--snow-count: 150;
			--snow-size: 3;
			--snow-speed: 1.2;
			--control-active: #a78bfa;
		}

		* { box-sizing: border-box; }

		#snowCanvas {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			pointer-events: none;
			z-index: -1;
			mix-blend-mode: screen;
		}

		body {
			margin: 0;
			padding: 0;
			background: #000000;
			color: var(--text);
			font-family: var(--font-family);
			line-height: 1.6;
			overflow-x: hidden;
		}

		/* Animated background */
		body::before {
			content: '';
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: linear-gradient(135deg, #000000 0%, #0a0015 50%, #000000 100%);
			z-index: -2;
		}

		/* Stars effect */
		body::after {
			content: '';
			position: fixed;
			width: 100%;
			height: 100%;
			background-image:
				radial-gradient(2px 2px at 20px 30px, white, transparent),
				radial-gradient(2px 2px at 60px 70px, white, transparent),
				radial-gradient(1px 1px at 50px 50px, white, transparent),
				radial-gradient(1px 1px at 130px 80px, white, transparent),
				radial-gradient(2px 2px at 90px 150px, white, transparent);
			background-repeat: repeat;
			background-size: 200px 200px;
			opacity: 0.4;
			animation: starsMove 100s linear infinite;
			z-index: -1;
			pointer-events: none;
		}

		@keyframes starsMove {
			from { transform: translateY(0); }
			to { transform: translateY(-200px); }
		}

		.settings-panel-large {
			display: none;
			position: fixed;
			top: 64px;
			right: 24px;
			width: 920px;
			max-width: calc(100% - 48px);
			background: rgba(255, 255, 255, 0.03);
			backdrop-filter: blur(20px);
			border: 1px solid rgba(139, 92, 246, 0.3);
			color: var(--text);
			border-radius: 16px;
			box-shadow: 0 10px 40px rgba(0, 0, 0, 0.6);
			z-index: 1200;
			padding: 14px;
			font-size: 14px;
			overflow: hidden;
		}

		.settings-header {
			display: flex;
			align-items: center;
			justify-content: space-between;
			gap: 12px;
			margin-bottom: 10px;
			cursor: move;
		}

		.settings-title {
			font-size: 18px;
			color: var(--accent);
			margin: 0;
			font-weight: 700;
		}

		.settings-close {
			background: transparent;
			border: 1px solid rgba(255, 255, 255, 0.06);
			padding: 6px 10px;
			border-radius: 8px;
			color: var(--text);
			cursor: pointer;
		}

		.settings-body {
			max-height: 62vh;
			overflow: auto;
			padding-right: 8px;
		}

		.section {
			margin-bottom: 12px;
		}

		.section h4 {
			margin: 0 0 6px 0;
			color: var(--muted);
			font-size: 13px;
		}

		.row {
			display: flex;
			gap: 12px;
			flex-wrap: wrap;
		}

		.col {
			flex: 1;
			min-width: 180px;
		}

		.label {
			display: block;
			margin-bottom: 6px;
			color: var(--muted);
			font-size: 13px;
		}

		input[type="color"],
		input[type="range"],
		select,
		input[type="number"] {
			width: 100%;
			padding: 8px;
			border-radius: 8px;
			border: none;
			background: rgba(255, 255, 255, 0.02);
			color: var(--text);
		}

		.small {
			width: 120px;
		}

		.actions {
			display: flex;
			gap: 8px;
			justify-content: flex-end;
			margin-top: 8px;
		}

		.btn-primary {
			background: linear-gradient(135deg, #8b5cf6, #7c3aed);
			border: 1px solid rgba(255, 255, 255, 0.2);
			color: #fff;
			padding: 8px 12px;
			border-radius: 8px;
			cursor: pointer;
			font-weight: 600;
			transition: all 0.3s;
			box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
		}

		.btn-primary:hover {
			background: linear-gradient(135deg, #a78bfa, #8b5cf6);
			transform: translateY(-2px);
			box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
		}

		.btn-ghost {
			background: rgba(139, 92, 246, 0.2);
			border: 1px solid rgba(139, 92, 246, 0.3);
			color: var(--text);
			padding: 8px 12px;
			border-radius: 8px;
			cursor: pointer;
			font-weight: 600;
			transition: all 0.3s;
		}

		.btn-ghost:hover {
			background: rgba(139, 92, 246, 0.3);
			transform: translateY(-1px);
		}

		.music-player {
			position: fixed;
			bottom: 20px;
			right: 20px;
			width: 280px;
			background: rgba(255, 255, 255, 0.03);
			backdrop-filter: blur(20px);
			border: 1px solid rgba(139, 92, 246, 0.3);
			border-radius: 20px;
			box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
			padding: 15px 20px;
			z-index: 1000;
			color: var(--text);
			font-family: var(--font-family);
		}

		.player-header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 12px;
			padding-bottom: 8px;
			box-shadow: 0 1px 0 rgba(255, 255, 255, 0.05);
		}

		#currentTrackTitle {
			font-size: 16px;
			font-weight: 700;
			color: var(--accent);
			overflow: hidden;
			white-space: nowrap;
			text-overflow: ellipsis;
			max-width: 200px;
			text-shadow: 0 0 4px var(--accent-shadow);
		}

		.player-controls {
			display: flex;
			align-items: center;
			gap: 12px;
		}

		.control-btn,
		.play-btn {
			background: rgba(255, 255, 255, 0.08);
			border: none;
			color: var(--text);
			border-radius: 10px;
			cursor: pointer;
			transition: background 0.3s, box-shadow 0.3s, transform 0.1s;
			flex-shrink: 0;
			box-shadow: 0 0 5px var(--accent-shadow);
		}

		#repeatShuffleBtn.active {
			background: var(--control-active);
			color: var(--bg);
			box-shadow: 0 0 10px var(--control-active);
		}

		#repeatShuffleBtn.active svg {
			fill: var(--bg);
		}

		.control-btn:active,
		.play-btn:active {
			transform: scale(0.95);
		}

		.control-btn {
			padding: 8px 14px;
			font-size: 14px;
			font-weight: bold;
		}

		.play-btn {
			width: 40px;
			height: 40px;
			padding: 0;
			display: flex;
			align-items: center;
			justify-content: center;
			border-radius: 50%;
			background: linear-gradient(135deg, #8b5cf6, #7c3aed);
		}

		.play-btn svg {
			fill: var(--text);
			width: 20px;
			height: 20px;
		}

		.control-btn:hover {
			background: var(--accent);
			box-shadow: 0 0 12px var(--accent-shadow);
		}

		.play-btn:hover {
			background: var(--accent);
			box-shadow: 0 0 15px var(--accent);
		}

		.volume-slider-container {
			flex-grow: 1;
			display: flex;
			align-items: center;
		}

		#volumeSlider {
			-webkit-appearance: none;
			appearance: none;
			width: 100%;
			height: 6px;
			background: rgba(255, 255, 255, 0.15);
			outline: none;
			border-radius: 3px;
		}

		#volumeSlider::-webkit-slider-thumb {
			-webkit-appearance: none;
			appearance: none;
			width: 16px;
			height: 16px;
			border-radius: 50%;
			background: var(--accent);
			cursor: pointer;
			box-shadow: 0 0 10px var(--accent-shadow);
			border: 3px solid var(--bg);
		}

		#volumeSlider::-moz-range-thumb {
			width: 16px;
			height: 16px;
			border-radius: 50%;
			background: var(--accent);
			cursor: pointer;
			border: 3px solid var(--bg);
			box-shadow: 0 0 10px var(--accent-shadow);
		}

		.playlist-menu {
			position: fixed;
			bottom: 220px;
			right: 20px;
			width: 320px;
			max-height: 400px;
			background: rgba(255, 255, 255, 0.03);
			backdrop-filter: blur(20px);
			border: 1px solid rgba(139, 92, 246, 0.3);
			border-radius: 20px;
			box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
			z-index: 999;
			display: none;
			flex-direction: column;
			overflow: hidden;
		}

		.playlist-menu-header {
			padding: 15px;
			font-size: 18px;
			font-weight: 700;
			color: var(--accent);
			border-bottom: 1px solid rgba(255, 255, 255, 0.05);
			background: rgba(0, 0, 0, 0.7);
			backdrop-filter: blur(5px);
			position: sticky;
			top: 0;
			display: flex;
			flex-direction: column;
		}

		.playlist-menu-list {
			list-style: none;
			padding: 0;
			margin: 0;
			overflow-y: auto;
			color: var(--text);
		}

		.playlist-item {
			display: flex;
			align-items: center;
			padding: 10px 15px;
			cursor: pointer;
			transition: background 0.2s;
			border-bottom: 1px solid rgba(255, 255, 255, 0.02);
		}

		.playlist-item:hover {
			background: rgba(255, 255, 255, 0.05);
		}

		.playlist-item.active {
			background: rgba(139, 92, 246, 0.2);
			border-left: 3px solid var(--accent);
			padding-left: 12px;
		}

		.playlist-item-art {
			width: 40px;
			height: 40px;
			border-radius: 5px;
			margin-right: 10px;
			object-fit: cover;
			box-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
		}

		.playlist-item-info {
			flex-grow: 1;
			overflow: hidden;
		}

		.playlist-item-title {
			font-size: 14px;
			font-weight: 600;
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		.playlist-item-artist {
			font-size: 12px;
			color: var(--muted);
			white-space: nowrap;
			overflow: hidden;
			text-overflow: ellipsis;
		}

		#togglePlaylistBtn {
			background: transparent;
			border: none;
			color: var(--text);
			cursor: pointer;
			padding: 0 5px;
		}

		#togglePlaylistBtn svg {
			fill: var(--text);
			width: 20px;
			height: 20px;
			transition: fill 0.3s;
		}

		#togglePlaylistBtn:hover svg {
			fill: var(--accent);
		}

		@media (max-width: 980px) {
			.settings-panel-large {
				left: 12px;
				right: 12px;
				top: 72px;
				width: calc(100% - 24px);
			}
		}

		@media (max-width: 500px) {
			.music-player {
				width: calc(100% - 40px);
				bottom: 10px;
				right: 10px;
				left: 20px;
				padding: 10px 15px;
			}

			#currentTrackTitle {
				max-width: 70%;
			}

			.playlist-menu {
				width: calc(100% - 40px);
				bottom: 150px;
				right: 20px;
			}
		}
	</style>
</head>

<body>
	<canvas id="snowCanvas"></canvas>

	<header style="background: transparent !important; box-shadow: none;">
		<h1 style="color: #ffffff !important;">Gaming Center</h1>
		<input type="text" id="searchInput" placeholder="Search games..." />
		<button id="discordBtn" style="display: none;">Join Discord</button>
		<button id="customizeBtn">Customize</button>
	</header>

	<div id="gameInfo">
		<p id="gameCount">Games: 0</p>
	</div>

	<div id="gameContainer"></div>

	<div class="modal" id="gameModal">
		<div class="modal-content">
			<button id="closeModal">×</button>
			<h2 id="gameTitle"></h2>
			<iframe id="gameFrame" src="" frameborder="0"></iframe>
			<div class="controls">
				<button id="downloadBtn">Download</button>
				<button id="fullscreenBtn">Fullscreen</button>
				<button id="aboutBlankBtn">Open in About:blank</button>
				<button id="blobBtn">Open in Blob URL</button>
			</div>
		</div>
	</div>

	<div class="settings-panel-large" id="settingsPanel" role="dialog" aria-label="Site customization">
		<div class="settings-header" id="settingsDrag">
			<div style="display: flex; gap: 12px; align-items: center">
				<span class="settings-title">Site Customization</span>
				<small style="color: var(--muted)">(drag header to move)</small>
			</div>
			<div></div>
		</div>

		<div class="settings-body">
			<div class="section">
				<h4>Presets & Quick Actions</h4>
				<div class="row">
					<div class="col" style="display: flex; gap: 8px; flex-wrap: wrap">
						<button class="btn-primary" data-preset="Violet">Violet</button>
						<button class="btn-primary" data-preset="Inferno">Inferno</button>
						<button class="btn-primary" data-preset="mathias">mathias</button>
						<button class="btn-primary" data-preset="kirby">kirby</button>
						<button class="btn-primary" data-preset="Ocean">Ocean</button>
						<button class="btn-primary" data-preset="Neon">Neon</button>
						<button class="btn-primary" data-preset="Retro">Retro</button>
						<button class="btn-ghost" data-preset="Dark">Dark</button>
						<button class="btn-ghost" data-preset="Light">Light</button>
					</div>
					<div class="col" style="display: flex;justify-content: flex-end;align-items: center;">
						<button class="btn-primary" id="exportBtn">Export JSON</button>
						<button class="btn-ghost" id="importBtn">Import JSON</button>
						<input type="file" id="importFile" accept=".json" style="display: none"/>
						<button class="btn-ghost" id="resetBtn">Reset Defaults</button>
					</div>
				</div>
			</div>

			<div class="section">
				<h4>Colors & Typography</h4>
				<div class="row">
					<div class="col">
						<label class="label">Background color</label>
						<input id="bgColor" type="color" value="#000000" />
            </div>
						<div class="col">
							<label class="label">Header color</label>
							<input id="headerColor" type="color" value="#000000" />
            </div>
							<div class="col">
								<label class="label">Text color</label>
								<input id="textColor" type="color" value="#ffffff" />
            </div>
								<div class="col">
									<label class="label">Muted / Secondary text</label>
									<input id="mutedColor" type="color" value="#c4b5fd" />
            </div>
								</div>

								<div class="row" style="margin-top: 10px">
									<div class="col">
										<label class="label">Accent color</label>
										<input id="accentColor" type="color" value="#8b5cf6" />
            </div>
										<div class="col">
											<label class="label">Accent dark</label>
											<input id="accentDark" type="color" value="#7c3aed" />
            </div>
											<div class="col">
												<label class="label">Glow (shadow) color</label>
												<input id="glowColor" type="color" value="#8b5cf6" />
            </div>
												<div class="col">
													<label class="label">Card background</label>
													<input id="cardBg" type="color" value="#000000" />
            </div>
												</div>

												<div class="row" style="margin-top: 10px">
													<div class="col">
														<label class="label">Font family</label>
														<select id="fontFamily">
                <option value="Arial, Helvetica, sans-serif">System - Arial</option>
                <option value="'Segoe UI', Tahoma, Geneva, Verdana, sans-serif">Segoe UI</option>
                <option value="'Roboto', Arial, sans-serif">Roboto</option>
                <option value="'VT323', monospace">VT323 (gamey)</option>
                <option value="'Press Start 2P', cursive">Press Start (pixel)</option>
              </select>
													</div>
													<div class="col">
														<label class="label">Card radius (px)</label>
														<input id="cardRadius" type="range" min="0" max="40" value="10" />
            </div>
														<div class="col">
															<label class="label">Glow size (px)</label>
															<input id="glowSize" type="range" min="4" max="60" value="15" />
            </div>
															<div class="col">
																<label class="label">Glow strength (0-1)</label>
																<input id="glowStrength" type="range" min="0" max="1" step="0.01" value="0.25"/>
            </div>
															</div>
														</div>

														<div class="section">
															<h4>Snow & Particles</h4>
															<div class="row">
																<div class="col">
																	<label class="label">Snow color</label>
																	<input id="snowColor" type="color" value="#c4b5fd" />
            </div>
																	<div class="col">
																		<label class="label">Snow count: <span id="snowCountLabel">150</span></label>
																		<input id="snowCount" type="range" min="0" max="400" value="150"/>
            </div>
																		<div class="col">
																			<label class="label">Snow size: <span id="snowSizeLabel">3</span></label>
																			<input id="snowSize" type="range" min="1" max="10" value="3" />
            </div>
																			<div class="col">
																				<label class="label">Snow speed: <span id="snowSpeedLabel">1.2</span></label>
																				<input id="snowSpeed" type="range" min="0.2" max="4" step="0.1" value="1.2"/>
            </div>
																			</div>
																		</div>
																	</div>

																	<div class="actions">
																		<button class="btn-ghost" id="applyBtn">Apply (autosaves)</button>
																		<button class="btn-primary" id="saveBtn">Save</button>
																	</div>
																</div>

																<div id="playlistMenu" class="playlist-menu">
																	<div class="playlist-menu-header"
																		id="playlistMenuDrag">
																		<div>Songs</div>
																		<input type="text" id="playlistSearch" placeholder="Search songs..." style="width: calc(96% - 5px);margin-top: 10px;padding: 8px;border-radius: 8px;border: none;background: rgba(255, 255, 255, 0.05);color: var(--text);"/>
      </div>
																		<ul id="playlistMenuList"
																			class="playlist-menu-list"></ul>
																	</div>

																	<div id="musicPlayer" class="music-player">
																		<div class="player-header">
																			<span id="currentTrackTitle">Loading...</span>
																			<div
																				style="display: flex; align-items: center; gap: 8px">
																				<button id="togglePlaylistBtn" title="Show Playlist">
            <svg viewBox="0 0 24 24"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" fill="currentColor"/></svg>
          </button>
																				<button id="togglePlayBtn" class="play-btn">
            <svg viewBox="0 0 24 24" id="playIcon"><path d="M8 5v14l11-7z" /></svg>
            <svg viewBox="0 0 24 24" id="pauseIcon" style="display: none"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z" /></svg>
          </button>
																			</div>
																		</div>
																		<div class="player-controls">
																			<button id="repeatShuffleBtn" class="control-btn" title="Repeat/Shuffle">
          <svg viewBox="0 0 24 24" id="repeatIcon" style="width: 20px;height: 20px;fill: currentColor;display: block;"><path d="M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"/></svg>
          <svg viewBox="0 0 24 24" id="repeatOneIcon" style="width: 20px; height: 20px; fill: currentColor; display: none"><path d="M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4zm-4-1h-2v-2h2v2z"/></svg>
          <svg viewBox="0 0 24 24" id="shuffleIcon" style="width: 20px; height: 20px; fill: currentColor; display: none"><path d="M10.59 9.17l-1.42 1.42 2.82 2.82 1.42-1.42c1.4-1.4 3.6-1.4 5.06 0l1.41-1.41c-2.12-2.12-5.12-2.31-7.27-.61L8 8.12V6h2V4H6v4h2v1.41l2.59 2.59L12 11.41l-1.41-1.42zm7.41 2.58l-1.42 1.42-2.83-2.83-1.41 1.41c1.4 1.4 3.6 1.4 5.06 0l1.41 1.41c-2.12 2.12-5.12 2.31-7.27.61L8 15.88V18H6v2h4v-4H8v-1.41l2.59-2.59L12 14.59l1.41 1.41 2.83-2.83 1.42-1.42z"/></svg>
        </button>
																			<button id="prevTrackBtn" class="control-btn"><<</button>
																			<div id="volumeControl"
																				class="volume-slider-container">
																				<input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="0.5" title="Volume"/>
        </div>
																				<button id="nextTrackBtn" class="control-btn">>></button>
																			</div>
																			<audio id="audioPlayer"
																				preload="auto"></audio>
																		</div>

																		<script>
																			var DEFAULTS = {
        bg: "#000000", header: "#000000", text: "#ffffff", muted: "#c4b5fd",
        accent: "#8b5cf6", accentDark: "#7c3aed", glowColor: "#8b5cf6", cardBg: "#000000",
        cardRadius: 16, glowSize: 15, glowStrength: 0.3,
        fontFamily: "'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif",
        snowColor: "#c4b5fd", snowCount: 150, snowSize: 3, snowSpeed: 1.2
      };

      var customizeBtn = document.getElementById("customizeBtn");
      var settingsPanel = document.getElementById("settingsPanel");
      var settingsDrag = document.getElementById("settingsDrag");

      var els = {
        bgColor: document.getElementById("bgColor"),
        headerColor: document.getElementById("headerColor"),
        textColor: document.getElementById("textColor"),
        mutedColor: document.getElementById("mutedColor"),
        accentColor: document.getElementById("accentColor"),
        accentDark: document.getElementById("accentDark"),
        glowColor: document.getElementById("glowColor"),
        cardBg: document.getElementById("cardBg"),
        cardRadius: document.getElementById("cardRadius"),
        glowSize: document.getElementById("glowSize"),
        glowStrength: document.getElementById("glowStrength"),
        fontFamily: document.getElementById("fontFamily"),
        snowColor: document.getElementById("snowColor"),
        snowCount: document.getElementById("snowCount"),
        snowSize: document.getElementById("snowSize"),
        snowSpeed: document.getElementById("snowSpeed"),
        snowCountLabel: document.getElementById("snowCountLabel"),
        snowSizeLabel: document.getElementById("snowSizeLabel"),
        snowSpeedLabel: document.getElementById("snowSpeedLabel")
      };

      var applyBtn = document.getElementById("applyBtn");
      var saveBtn = document.getElementById("saveBtn");
      var resetBtn = document.getElementById("resetBtn");
      var exportBtn = document.getElementById("exportBtn");
      var importBtn = document.getElementById("importBtn");
      var importFile = document.getElementById("importFile");

      function setVar(name, val) {
        document.documentElement.style.setProperty(name, val);
      }

      function hexToRGBA(hex, alpha) {
        alpha = alpha || 1;
        if(!hex) return "rgba(255,255,255," + alpha + ")";
        var h = hex.replace("#","");
        var num = parseInt(h,16);
        var r = (num >> 16) & 255;
        var g = (num >> 8) & 255;
        var b = num & 255;
        return "rgba("+r+","+g+","+b+","+alpha+")";
      }

      function applySettings(s) {
        var settings = {};
        for(var k in DEFAULTS) settings[k] = DEFAULTS[k];
        if(s) for(var k in s) settings[k] = s[k];
        
        setVar("--bg", settings.bg);
        setVar("--header-bg", settings.header);
        setVar("--text", settings.text);
        setVar("--muted", settings.muted);
        setVar("--accent", settings.accent);
        setVar("--accent-dark", settings.accentDark);
        setVar("--accent-shadow", hexToRGBA(settings.glowColor, 0.3));

        var cards = document.querySelectorAll(".game-card");
        for(var i = 0; i < cards.length; i++) {
          cards[i].style.boxShadow = "0 0 "+settings.glowSize+"px "+hexToRGBA(settings.glowColor, settings.glowStrength);
        }

        setVar("--card-bg", settings.cardBg);
        setVar("--card-radius", settings.cardRadius+"px");
        setVar("--card-shadow", "0 0 "+Math.max(6,settings.glowSize/1.6)+"px "+hexToRGBA(settings.glowColor,0.12));
        setVar("--glow-size", settings.glowSize+"px");
        setVar("--glow-strength", settings.glowStrength);
        setVar("--font-family", settings.fontFamily);
        setVar("--snow-color", hexToRGBA(settings.snowColor,1));
        setVar("--snow-count", settings.snowCount);
        setVar("--snow-size", settings.snowSize);
        setVar("--snow-speed", settings.snowSpeed);

        document.body.style.background = settings.bg;
        document.body.style.color = settings.text;
        var header = document.querySelector("header");
        if(header) header.style.background = settings.header;
        
        var allCards = document.querySelectorAll(".game-card");
        for(var i=0; i<allCards.length; i++){
          allCards[i].style.background = settings.cardBg;
        }
        
        var gameFrame = document.getElementById("gameFrame");
        if(gameFrame) gameFrame.style.borderColor = settings.accent;
      }

      var STORAGE_KEY = "elite_gamez_theme_v1";

      function saveSettings(obj) {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(obj));
        saveBtn.textContent = "Saved ✓";
        setTimeout(function() {
          saveBtn.textContent = "Save";
        }, 900);
      }

      function loadSettings() {
        var raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return DEFAULTS;
        try {
          var parsed = JSON.parse(raw);
          var result = {};
          for(var k in DEFAULTS) result[k] = DEFAULTS[k];
          for(var k in parsed) result[k] = parsed[k];
          return result;
        } catch(e) {
          console.error("bad json",e);
          return DEFAULTS;
        }
      }

      function resetToDefaults() {
        localStorage.removeItem(STORAGE_KEY);
        updateUIFromSettings(DEFAULTS);
        applySettings(DEFAULTS);
        updateSnow(DEFAULTS.snowCount, DEFAULTS.snowSize, DEFAULTS.snowSpeed, DEFAULTS.snowColor);
      }

      function updateUIFromSettings(s) {
        els.bgColor.value = s.bg;
        els.headerColor.value = s.header;
        els.textColor.value = s.text;
        els.mutedColor.value = s.muted;
        els.accentColor.value = s.accent;
        els.accentDark.value = s.accentDark;
        els.glowColor.value = s.glowColor;
        els.cardBg.value = s.cardBg;
        els.cardRadius.value = s.cardRadius;
        els.glowSize.value = s.glowSize;
        els.glowStrength.value = s.glowStrength;
        els.fontFamily.value = s.fontFamily;
        els.snowColor.value = s.snowColor;
        els.snowCount.value = s.snowCount;
        els.snowSize.value = s.snowSize;
        els.snowSpeed.value = s.snowSpeed;
        els.snowCountLabel.textContent = s.snowCount;
        els.snowSizeLabel.textContent = s.snowSize;
        els.snowSpeedLabel.textContent = s.snowSpeed;
      }

      function readSettingsFromUI() {
        return {
          bg: els.bgColor.value,
          header: els.headerColor.value,
          text: els.textColor.value,
          muted: els.mutedColor.value,
          accent: els.accentColor.value,
          accentDark: els.accentDark.value,
          glowColor: els.glowColor.value,
          cardBg: els.cardBg.value,
          cardRadius: Number(els.cardRadius.value),
          glowSize: Number(els.glowSize.value),
          glowStrength: Number(els.glowStrength.value),
          fontFamily: els.fontFamily.value,
          snowColor: els.snowColor.value,
          snowCount: Number(els.snowCount.value),
          snowSize: Number(els.snowSize.value),
          snowSpeed: Number(els.snowSpeed.value)
        };
      }

      function wireControls() {
        var allInputs = Object.values(els);
        for(var i=0; i<allInputs.length; i++) {
          var input = allInputs[i];
          if(!input) continue;
          
          input.addEventListener("input", function(e) {
            var t = e.target;
            if(t === els.snowCount) els.snowCountLabel.textContent = t.value;
            if(t === els.snowSize) els.snowSizeLabel.textContent = t.value;
            if(t === els.snowSpeed) els.snowSpeedLabel.textContent = t.value;
            
            var currentSettings = readSettingsFromUI();
            applySettings(currentSettings);
            updateSnow(currentSettings.snowCount, currentSettings.snowSize, currentSettings.snowSpeed, currentSettings.snowColor);
            
            if(window._autosaveTimeout) clearTimeout(window._autosaveTimeout);
            window._autosaveTimeout = setTimeout(function(){
              saveSettings(currentSettings);
            }, 900);
          });
        }

        applyBtn.addEventListener("click", function() {
          var s = readSettingsFromUI();
          applySettings(s);
          updateSnow(s.snowCount, s.snowSize, s.snowSpeed, s.snowColor);
          saveSettings(s);
        });
        
        saveBtn.addEventListener("click", function(){
          saveSettings(readSettingsFromUI());
        });
        
        resetBtn.addEventListener("click", function() {
          if(!confirm("like the orange color better? same")) return;
          resetToDefaults();
        });

        exportBtn.addEventListener("click", function() {
          var data = readSettingsFromUI();
          var blob = new Blob([JSON.stringify(data,null,2)], {type:"application/json"});
          var a = document.createElement("a");
          a.href = URL.createObjectURL(blob);
          a.download = "theme.json";
          document.body.appendChild(a);
          a.click();
          a.remove();
        });
        
        importBtn.addEventListener("click", function(){
          importFile.click();
        });
        
        importFile.addEventListener("change", function(e) {
          var file = e.target.files && e.target.files[0];
          if(!file) return;
          var reader = new FileReader();
          reader.onload = function() {
            try {
              var imported = JSON.parse(reader.result);
              var merged = {};
              for(var k in DEFAULTS) merged[k] = DEFAULTS[k];
              for(var k in imported) merged[k] = imported[k];
              updateUIFromSettings(merged);
              applySettings(merged);
              saveSettings(merged);
              updateSnow(merged.snowCount, merged.snowSize, merged.snowSpeed, merged.snowColor);
              alert("Imported!");
            } catch(err) {
              alert("Failed to import - bad JSON");
            }
          };
          reader.readAsText(file);
          importFile.value = "";
        });

        var presetButtons = document.querySelectorAll("[data-preset]");
        for(var i=0; i<presetButtons.length; i++) {
          presetButtons[i].addEventListener("click", function(e) {
            var presetName = e.target.getAttribute("data-preset");
            applyPreset(presetName);
          });
        }
      }

      var PRESETS = {
        Violet: {
          bg:"#000000", header:"#000000", text:"#ffffff", muted:"#c4b5fd",
          accent:"#8b5cf6", accentDark:"#7c3aed", glowColor:"#8b5cf6",
          cardBg:"#000000", cardRadius:16, glowSize:15, glowStrength:0.3,
          fontFamily:"'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif",
          snowColor:"#c4b5fd", snowCount:150, snowSize:3, snowSpeed:1.2
        },
        Inferno: {
          bg:"#0a0a0a", header:"#1a1a1a", text:"#ffffff", muted:"#cccccc",
          accent:"#ff00aa", accentDark:"#ff00aa", glowColor:"#ff00ff",
          cardBg:"#000000", cardRadius:12, glowSize:25, glowStrength:0.5,
          fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
          snowColor:"#ffffff", snowCount:160, snowSize:3, snowSpeed:1.3
        },
        mathias: {
          bg:"#000000", header:"#000000", text:"#ffffff", muted:"#f8f1f1",
          accent:"#828282", accentDark:"#3d3d3d", glowColor:"#ffffff",
          cardBg:"#000000", cardRadius:10, glowSize:25, glowStrength:0.5,
          fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
          snowColor:"#ffffff", snowCount:160, snowSize:3, snowSpeed:1.4
        },
        kirby: {
          bg:"#1A1A2E", header:"#1A1A2E", text:"#FFFFFF", muted:"#F8F1F1",
          accent:"#FF8EC6", accentDark:"#A50017", glowColor:"#FFC9D1",
          cardBg:"#2B2B45", cardRadius:10, glowSize:25, glowStrength:0.5,
          fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",
          snowColor:"#e660ce", snowCount:160, snowSize:3, snowSpeed:1.4
        },
        Ocean: {
          bg:"#021b2c", header:"#023047", text:"#e8f6ff", muted:"#a7d3f0",
          accent:"#00a3ff", accentDark:"#006bb3", glowColor:"#00baff",
          cardBg:"#00121a", cardRadius:12, glowSize:18, glowStrength:0.28,
          fontFamily:"'Roboto', Arial, sans-serif",
          snowColor:"#c8f0ff", snowCount:120, snowSize:3, snowSpeed:0.9
        },
        Neon: {
          bg:"#04040a", header:"#0b0b12", text:"#e7ffe7", muted:"#9ef3d1",
          accent:"#00ffb3", accentDark:"#00d18a", glowColor:"#00ffb3",
          cardBg:"#05050b", cardRadius:8, glowSize:30, glowStrength:0.5,
          fontFamily:"'VT323', monospace",
          snowColor:"#99ffdd", snowCount:200, snowSize:2, snowSpeed:1.6
        },
        Retro: {
          bg:"#0b0011", header:"#1a0337", text:"#ffe8d6", muted:"#ffd6a5",
          accent:"#ff66c4", accentDark:"#cc3aa0", glowColor:"#ff66c4",
          cardBg:"#140018", cardRadius:14, glowSize:12, glowStrength:0.2,
          fontFamily:"'Press Start 2P', cursive",
          snowColor:"#ffd6f0", snowCount:100, snowSize:4, snowSpeed:0.7
        },
        Dark: DEFAULTS,
        Light: {
          bg:"#f4f4f6", header:"#ffffff", text:"#111111", muted:"#666666",
          accent:"#0066ff", accentDark:"#0047b3", glowColor:"#66a3ff",
          cardBg:"#ffffff", cardRadius:8, glowSize:10, glowStrength:0.12,
          fontFamily:"Arial, Helvetica, sans-serif",
          snowColor:"#444444", snowCount:60, snowSize:2, snowSpeed:0.8
        }
      };

      function applyPreset(name) {
        if(!PRESETS[name]) return;
        var preset = PRESETS[name];
        updateUIFromSettings(preset);
        applySettings(preset);
        saveSettings(preset);
        updateSnow(preset.snowCount, preset.snowSize, preset.snowSpeed, preset.snowColor);
      }

      customizeBtn.addEventListener("click", function() {
        if(settingsPanel.style.display === "block") {
          settingsPanel.style.display = "none";
        } else {
          settingsPanel.style.display = "block";
        }
      });

      (function() {
        var isDragging = false;
        var startX, startY, initialLeft, initialTop;
        
        settingsDrag.addEventListener("pointerdown", function(e) {
          isDragging = true;
          startX = e.clientX;
          startY = e.clientY;
          var rect = settingsPanel.getBoundingClientRect();
          initialLeft = rect.left;
          initialTop = rect.top;
          settingsDrag.setPointerCapture(e.pointerId);
        });
        
        window.addEventListener("pointermove", function(e) {
          if(!isDragging) return;
          var deltaX = e.clientX - startX;
          var deltaY = e.clientY - startY;
          var newLeft = Math.max(8, Math.min(window.innerWidth - settingsPanel.offsetWidth - 8, initialLeft + deltaX));
          var newTop = Math.max(8, Math.min(window.innerHeight - 80, initialTop + deltaY));
          settingsPanel.style.left = newLeft + "px";
          settingsPanel.style.top = newTop + "px";
          settingsPanel.style.right = "auto";
          settingsPanel.style.position = "fixed";
        });
        
        window.addEventListener("pointerup", function() {
          isDragging = false;
        });
      })();

      var canvas = document.getElementById("snowCanvas");
      var ctx = canvas.getContext("2d");
      var snowflakes = [];
      var snowConfig = {
        count: DEFAULTS.snowCount,
        size: DEFAULTS.snowSize,
        speed: DEFAULTS.snowSpeed,
        color: DEFAULTS.snowColor
      };

      function resizeCanvas() {
        canvas.width = innerWidth;
        canvas.height = innerHeight;
      }
      window.addEventListener("resize", resizeCanvas);
      resizeCanvas();

      function createSnow(count, size) {
        snowflakes = [];
        for(var i=0; i<count; i++) {
          snowflakes.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            r: Math.random() * size + 0.5,
            d: Math.random() * 1.5 + 0.2,
            sway: Math.random() * 2 * Math.PI,
            swayAmp: Math.random() * 20
          });
        }
      }

      function updateSnow(count, size, speed, color) {
        snowConfig.count = count;
        snowConfig.size = size;
        snowConfig.speed = speed;
        snowConfig.color = color;
        createSnow(count, size);
      }

      function drawSnow() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.beginPath();
        ctx.fillStyle = hexToRGBA(snowConfig.color || "#ffffff", 0.95);

        if(snowflakes.length !== snowConfig.count) {
          createSnow(snowConfig.count, snowConfig.size);
        }

        for(var i=0; i<snowflakes.length; i++) {
          var flake = snowflakes[i];
          ctx.moveTo(flake.x, flake.y);
          ctx.arc(flake.x, flake.y, flake.r, 0, Math.PI*2);
          flake.y += flake.d * snowConfig.speed;
          flake.sway += 0.01 + Math.random()*0.02;
          flake.x += Math.sin(flake.sway) * 0.6;
          
          if(flake.y > canvas.height + 20) {
            flake.x = Math.random() * canvas.width;
            flake.y = -10 - Math.random()*40;
          }
          if(flake.x > canvas.width+50) flake.x = -20;
          if(flake.x < -50) flake.x = canvas.width+20;
        }
        ctx.fill();
        requestAnimationFrame(drawSnow);
      }

      var initialSettings = loadSettings();
      updateUIFromSettings(initialSettings);
      applySettings(initialSettings);
      updateSnow(initialSettings.snowCount, initialSettings.snowSize, initialSettings.snowSpeed, initialSettings.snowColor);
      wireControls();
      drawSnow();
																		</script>

																		<script>
																			var audioPlayer = document.getElementById("audioPlayer");
      var togglePlayBtn = document.getElementById("togglePlayBtn");
      var prevTrackBtn = document.getElementById("prevTrackBtn");
      var nextTrackBtn = document.getElementById("nextTrackBtn");
      var volumeSlider = document.getElementById("volumeSlider");
      var currentTrackTitle = document.getElementById("currentTrackTitle");
      var playIcon = document.getElementById("playIcon");
      var pauseIcon = document.getElementById("pauseIcon");
      var repeatShuffleBtn = document.getElementById("repeatShuffleBtn");
      var repeatIcon = document.getElementById("repeatIcon");
      var repeatOneIcon = document.getElementById("repeatOneIcon");
      var shuffleIcon = document.getElementById("shuffleIcon");
      var togglePlaylistBtn = document.getElementById("togglePlaylistBtn");
      var playlistMenu = document.getElementById("playlistMenu");
      var playlistMenuList = document.getElementById("playlistMenuList");

      var tracks = [];
      var currentTrack = 0;
      var originalTracks = [];
      var repeatMode = 1; 

      function loadTrack(idx, autoplay) {
        if(tracks.length === 0) return;
        currentTrack = (idx + tracks.length) % tracks.length;
        var track = tracks[currentTrack];
        audioPlayer.src = track.url;
        currentTrackTitle.textContent = track.title || "Unknown Track";
        audioPlayer.load();
        updatePlaylistUI();
        if(autoplay) {
          audioPlayer.play().catch(function(err){
            console.error("play error:",err);
          });
        }
      }

      function shuffleTracks() {
        if(tracks.length > 0 && tracks[0].url !== originalTracks[0].url) {
          tracks = originalTracks.slice();
        }

        var idx = tracks.length;
        while(idx !== 0) {
          var randomIdx = Math.floor(Math.random() * idx);
          idx--;
          var temp = tracks[idx];
          tracks[idx] = tracks[randomIdx];
          tracks[randomIdx] = temp;
        }
      }

      function onTrackEnded() {
        if(repeatMode === 2) {
          audioPlayer.currentTime = 0;
          audioPlayer.play();
        } else if(repeatMode === 1 || repeatMode === 3) {
          playNext(true);
        } else {
          if(currentTrack < tracks.length - 1) {
            playNext(false);
          } else {
            audioPlayer.pause();
            loadTrack(0);
          }
        }
      }

      function togglePlay() {
        if(audioPlayer.paused) {
          audioPlayer.play().catch(function(e){console.error(e);});
        } else {
          audioPlayer.pause();
        }
        updatePlayBtn();
      }

      function playNext(shouldPlay) {
        var next = currentTrack + 1;
        if(next >= tracks.length) {
          if(repeatMode === 1 || repeatMode === 3) {
            next = 0;
            if(repeatMode === 3) shuffleTracks();
          } else {
            return;
          }
        }
        loadTrack(next, shouldPlay);
      }

      function playPrev() {
        var prev = currentTrack - 1;
        if(prev < 0) {
          if(repeatMode === 1 || repeatMode === 3) {
            prev = tracks.length - 1;
          } else {
            prev = 0;
          }
        }
        loadTrack(prev, true);
      }

      function updatePlayBtn() {
        var playing = !audioPlayer.paused;
        playIcon.style.display = playing ? "none" : "block";
        pauseIcon.style.display = playing ? "block" : "none";
      }

      function cycleRepeatMode() {
        repeatMode = (repeatMode + 1) % 4;
        updateRepeatBtn();
      }

      function updateRepeatBtn() {
        repeatShuffleBtn.classList.remove("active");
        repeatIcon.style.display = "none";
        repeatOneIcon.style.display = "none";
        shuffleIcon.style.display = "none";

        if(repeatMode === 1) {
          repeatIcon.style.display = "block";
          repeatShuffleBtn.classList.add("active");
          repeatShuffleBtn.title = "Repeat All";
          audioPlayer.loop = false;
        } else if(repeatMode === 2) {
          repeatOneIcon.style.display = "block";
          repeatShuffleBtn.classList.add("active");
          repeatShuffleBtn.title = "Repeat One";
          audioPlayer.loop = true;
        } else if(repeatMode === 3) {
          shuffleIcon.style.display = "block";
          repeatShuffleBtn.classList.add("active");
          repeatShuffleBtn.title = "Shuffle";
          audioPlayer.loop = false;
        } else {
          repeatIcon.style.display = "block";
          repeatShuffleBtn.title = "No Repeat";
          audioPlayer.loop = false;
        }
      }

      function togglePlaylist() {
        var visible = playlistMenu.style.display === "flex";
        playlistMenu.style.display = visible ? "none" : "flex";
        if(!visible) {
          var active = playlistMenuList.querySelector(".playlist-item.active");
          if(active) {
            active.scrollIntoView({behavior:"smooth", block:"center"});
          }
        }
      }

      function renderPlaylist() {
        playlistMenuList.innerHTML = "";
        for(var i=0; i<tracks.length; i++) {
          var track = tracks[i];
          var li = document.createElement("li");
          li.classList.add("playlist-item");
          li.dataset.index = i;
          li.innerHTML = '<img class="playlist-item-art" src="'+(track.albumArt || "default_art.jpg")+'" alt="Album Art"/>'+
            '<div class="playlist-item-info">'+
            '<div class="playlist-item-title">'+(track.title || "Unknown")+'</div>'+
            '<div class="playlist-item-artist">'+(track.artist || "Unknown Artist")+'</div>'+
            '</div>';
          
          (function(index) {
            li.addEventListener("click", function() {
              loadTrack(index);
              audioPlayer.play();
            });
          })(i);
          
          playlistMenuList.appendChild(li);
        }
        updatePlaylistUI();
      }

      function updatePlaylistUI() {
        var items = playlistMenuList.querySelectorAll(".playlist-item");
        for(var i=0; i<items.length; i++) {
          items[i].classList.remove("active");
        }
        var activeItem = playlistMenuList.querySelector('[data-index="'+currentTrack+'"]');
        if(activeItem) activeItem.classList.add("active");
      }

      var playlistSearch = document.getElementById("playlistSearch");
      
      function filterPlaylist() {
        var q = playlistSearch.value.toLowerCase();
        var items = playlistMenuList.querySelectorAll(".playlist-item");
        for(var i=0; i<items.length; i++) {
          var item = items[i];
          var title = item.querySelector(".playlist-item-title").textContent.toLowerCase();
          var artist = item.querySelector(".playlist-item-artist").textContent.toLowerCase();
          if(title.includes(q) || artist.includes(q)) {
            item.style.display = "flex";
          } else {
            item.style.display = "none";
          }
        }
      }

      playlistSearch.addEventListener("input", filterPlaylist);

      togglePlayBtn.addEventListener("click", togglePlay);
      nextTrackBtn.addEventListener("click", function(){playNext(true);});
      prevTrackBtn.addEventListener("click", playPrev);
      togglePlaylistBtn.addEventListener("click", togglePlaylist);
      repeatShuffleBtn.addEventListener("click", cycleRepeatMode);
      audioPlayer.addEventListener("ended", onTrackEnded);
      audioPlayer.addEventListener("pause", updatePlayBtn);
      audioPlayer.addEventListener("play", updatePlayBtn);
      volumeSlider.addEventListener("input", function() {
        audioPlayer.volume = volumeSlider.value;
      });
      audioPlayer.volume = volumeSlider.value;

      fetch("https://cdn.jsdelivr.net/gh/elite-gamez/elite-gamez.github.io@main/music.json")
        .then(function(res) {
          if(!res.ok) throw new Error("HTTP "+res.status);
          return res.json();
        })
        .then(function(data) {
          if(Array.isArray(data) && data.length > 0) {
            originalTracks = data;
            tracks = originalTracks.slice();
            loadTrack(0);
            renderPlaylist();
            updateRepeatBtn();
          } else {
            currentTrackTitle.textContent = "No tracks found";
          }
        })
        .catch(function(err) {
          console.error("Error loading music:",err);
          currentTrackTitle.textContent = "Error loading music";
        });
																		</script>

																		<script>
																			// CDN base URL
      var CDN_BASE = "https://cdn.jsdelivr.net/gh/elite-gamez/elite-gamez.github.io@main/";

      // Function to fix paths (images/, img/, g/, music/, games.json, music.json)
      function fixPath(path) {
        if (!path || typeof path !== 'string') return path;

        // Already has CDN base URL or is an absolute URL
        if (path.includes('cdn.jsdelivr.net') || path.startsWith('http://') || path.startsWith('https://')) return path;

        // Redirect specific files and paths
        if (path === "games.json" || path.endsWith("/games.json")) {
          return CDN_BASE + "games.json";
        }
        if (path === "music.json" || path.endsWith("/music.json")) {
          return CDN_BASE + "music.json";
        }
        if (path.startsWith('images/')) {
          return CDN_BASE + path;
        }
        if (path.startsWith('img/')) {
          return CDN_BASE + path;
        }
        if (path.startsWith('music/')) {
          return CDN_BASE + path;
        }
        if (path.startsWith('g/')) {
          return CDN_BASE + path;
        }

        return path;
      }

      // Intercept fetch requests
      var originalFetch = window.fetch;
      window.fetch = function(url, options) {
        return originalFetch(fixPath(url), options);
      };

      // Intercept Image constructor
      var OriginalImage = window.Image;
      window.Image = function() {
        var img = new OriginalImage();
        var originalSrcDescriptor = Object.getOwnPropertyDescriptor(HTMLImageElement.prototype, 'src');

        Object.defineProperty(img, 'src', {
          get: function() {
            return originalSrcDescriptor.get.call(this);
          },
          set: function(value) {
            originalSrcDescriptor.set.call(this, fixPath(value));
          }
        });

        return img;
      };

      // Intercept createElement for img elements
      var originalCreateElement = document.createElement;
      document.createElement = function(tagName) {
        var element = originalCreateElement.call(document, tagName);
        if (tagName.toLowerCase() === 'img') {
          var originalSetAttribute = element.setAttribute.bind(element);
          element.setAttribute = function(name, value) {
            if (name === 'src') {
              value = fixPath(value);
            }
            return originalSetAttribute(name, value);
          };

          Object.defineProperty(element, 'src', {
            get: function() {
              return this.getAttribute('src');
            },
            set: function(value) {
              this.setAttribute('src', fixPath(value));
            }
          });
        }
        return element;
      };

      // Use MutationObserver to catch images added via innerHTML
      var observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          mutation.addedNodes.forEach(function(node) {
            // Check if the node itself is an img
            if (node.nodeName === 'IMG') {
              var currentSrc = node.getAttribute('src');
              if (currentSrc && !currentSrc.includes('cdn.jsdelivr.net')) {
                var fixedSrc = fixPath(currentSrc);
                if (fixedSrc !== currentSrc) {
                  node.src = fixedSrc;
                }
              }
            }
            // Check for img elements within added nodes
            if (node.querySelectorAll) {
              var images = node.querySelectorAll('img');
              images.forEach(function(img) {
                var currentSrc = img.getAttribute('src');
                if (currentSrc && !currentSrc.includes('cdn.jsdelivr.net')) {
                  var fixedSrc = fixPath(currentSrc);
                  if (fixedSrc !== currentSrc) {
                    img.src = fixedSrc;
                  }
                }
              });
            }
          });
        });
      });

      // Start observing when DOM is ready
      if (document.body) {
        observer.observe(document.body, { childList: true, subtree: true });
      } else {
        document.addEventListener('DOMContentLoaded', function() {
          observer.observe(document.body, { childList: true, subtree: true });
        });
      }

      // Intercept audio and iframe elements
      (function() {
        var originalCreateElement = document.createElement;
        document.createElement = function(tagName) {
          var element = originalCreateElement.call(document, tagName);
          var lowerTag = tagName.toLowerCase();

          if (lowerTag === 'iframe' || lowerTag === 'audio') {
            var originalSetAttr = element.setAttribute.bind(element);
            element.setAttribute = function(name, value) {
              if (name === 'src') {
                value = fixPath(value);
              }
              return originalSetAttr(name, value);
            };

            Object.defineProperty(element, 'src', {
              get: function() {
                return this.getAttribute('src');
              },
              set: function(value) {
                this.setAttribute('src', fixPath(value));
              },
              configurable: true
            });
          }
          return element;
        };
      })();

      // Intercept existing audio element on page
      (function() {
        var audioElements = document.querySelectorAll('audio');
        audioElements.forEach(function(audio) {
          var originalSrcDescriptor = Object.getOwnPropertyDescriptor(HTMLMediaElement.prototype, 'src');
          if (originalSrcDescriptor) {
            Object.defineProperty(audio, 'src', {
              get: function() {
                return originalSrcDescriptor.get.call(this);
              },
              set: function(value) {
                originalSrcDescriptor.set.call(this, fixPath(value));
              },
              configurable: true
            });
          }
        });
      })();

      // Also watch for new audio/iframe elements added to DOM
      var mediaObserver = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          mutation.addedNodes.forEach(function(node) {
            if (node.nodeName === 'AUDIO' || node.nodeName === 'IFRAME') {
              var currentSrc = node.getAttribute('src');
              if (currentSrc && !currentSrc.includes('cdn.jsdelivr.net') && !currentSrc.startsWith('http')) {
                var fixedSrc = fixPath(currentSrc);
                if (fixedSrc !== currentSrc) {
                  node.src = fixedSrc;
                }
              }
            }
          });
        });
      });

      if (document.body) {
        mediaObserver.observe(document.body, { childList: true, subtree: true });
      }

      // Intercept ALL iframe src property assignments
      (function() {
        var originalSrcDescriptor = Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype, 'src');

        function loadAndRenderGame(iframe, cdnUrl) {
          fetch(cdnUrl)
            .then(function(res) {
              if (!res.ok) throw new Error('HTTP ' + res.status);
              return res.text();
            })
            .then(function(html) {
              // Get the base path for relative resources
              var basePath = cdnUrl.substring(0, cdnUrl.lastIndexOf('/') + 1);

              // Create a base tag to handle relative URLs
              var baseTag = '<base href="' + basePath + '" target="_self">';

              // Also add a script to fix any remaining relative paths and handle window references
              var fixScript = '<script>' +
                'window.CDN_BASE = "' + CDN_BASE + '";' +
                'window.GAME_BASE = "' + basePath + '";' +
                '<\/script>';

              // Insert base tag and fix script into the head
              if (html.match(/<head[^>]*>/i)) {
                html = html.replace(/<head[^>]*>/i, function(match) {
                  return match + baseTag + fixScript;
                });
              } else if (html.match(/<html[^>]*>/i)) {
                html = html.replace(/<html[^>]*>/i, function(match) {
                  return match + '<head>' + baseTag + fixScript + '</head>';
                });
              } else if (html.match(/<!DOCTYPE[^>]*>/i)) {
                html = html.replace(/<!DOCTYPE[^>]*>/i, function(match) {
                  return match + '<html><head>' + baseTag + fixScript + '</head>';
                });
              } else {
                html = '<!DOCTYPE html><html><head>' + baseTag + fixScript + '</head>' + html + '</html>';
              }

              // Use Blob URL instead of srcdoc for better compatibility with WebGL/canvas games
              var blob = new Blob([html], { type: 'text/html' });
              var blobUrl = URL.createObjectURL(blob);

              // Clean up previous blob URL if exists
              if (iframe._blobUrl) {
                URL.revokeObjectURL(iframe._blobUrl);
              }
              iframe._blobUrl = blobUrl;

              // Remove sandbox restrictions
              iframe.removeAttribute('sandbox');
              originalSrcDescriptor.set.call(iframe, blobUrl);
            })
            .catch(function(err) {
              console.error('Error loading game from ' + cdnUrl + ':', err);
              // Fallback: show error with link
              var errorHtml = '<!DOCTYPE html><html><head><style>body{margin:0;display:flex;align-items:center;justify-content:center;height:100vh;background:#000;color:#fff;font-family:sans-serif;text-align:center;}</style></head><body><div><h2>Error loading game</h2><p><a href="' + cdnUrl + '" target="_blank" style="color:#8b5cf6;">Click here to open directly</a></p></div></body></html>';
              var errorBlob = new Blob([errorHtml], { type: 'text/html' });
              originalSrcDescriptor.set.call(iframe, URL.createObjectURL(errorBlob));
            });
        }

        Object.defineProperty(HTMLIFrameElement.prototype, 'src', {
          get: function() {
            return originalSrcDescriptor.get.call(this);
          },
          set: function(value) {
            var iframe = this;

            // Skip about:blank and empty values
            if (!value || value === 'about:blank') {
              originalSrcDescriptor.set.call(this, value);
              return;
            }

            // Skip already-absolute URLs (http/https) - load them directly
            if (value.startsWith('http://') || value.startsWith('https://')) {
              // If it's already a CDN URL for an HTML file, fetch and render it
              if (value.includes('cdn.jsdelivr.net') && value.endsWith('.html')) {
                loadAndRenderGame(iframe, value);
                return;
              }
              originalSrcDescriptor.set.call(this, value);
              return;
            }

            // Handle g/ paths - fetch and render
            if (value.startsWith('g/') || value.startsWith('/g/')) {
              var cleanPath = value.startsWith('/') ? value.substring(1) : value;
              var cdnUrl = CDN_BASE + cleanPath;
              loadAndRenderGame(iframe, cdnUrl);
              return;
            }

            // Handle paths that look like game paths (e.g., /game.html, game.html)
            if (value.endsWith('.html')) {
              var cleanPath = value.startsWith('/') ? value.substring(1) : value;
              // If it's just a filename like "game.html", assume it's in the g/ folder
              if (!cleanPath.includes('/')) {
                cleanPath = 'g/' + cleanPath;
              }
              var cdnUrl = CDN_BASE + cleanPath;
              loadAndRenderGame(iframe, cdnUrl);
              return;
            }

            // Default: apply fixPath for other paths
            originalSrcDescriptor.set.call(this, fixPath(value));
          },
          configurable: true
        });
      })();
																		</script>
																		<script src="https://cdn.jsdelivr.net/gh/elite-gamez/elite-gamez.github.io@main/js/script.js"></script>
																		<script>
      // Override aboutBlankBtn to work with blob URLs
      (function() {
        var aboutBlankBtn = document.getElementById('aboutBlankBtn');
        var gameFrame = document.getElementById('gameFrame');

        if (aboutBlankBtn && gameFrame) {
          aboutBlankBtn.addEventListener('click', function(e) {
            e.stopImmediatePropagation();
            e.preventDefault();

            var newTab = window.open('about:blank', '_blank');
            if (newTab) {
              // Get the current iframe src (which is a blob URL)
              var currentSrc = gameFrame.src;

              // If it's a blob URL, we need to fetch and recreate it for the new tab
              if (currentSrc && currentSrc.startsWith('blob:')) {
                // We stored the original CDN URL, so fetch it again for the new tab
                var gameTitle = document.getElementById('gameTitle');
                var title = gameTitle ? gameTitle.textContent : 'Game';

                // Get the blob content by fetching from the blob URL
                fetch(currentSrc)
                  .then(function(res) { return res.text(); })
                  .then(function(html) {
                    var fullHtml = '<!DOCTYPE html><html><head><title>' + title + '</title></head><body style="margin:0;padding:0;overflow:hidden;">' +
                      '<iframe srcdoc="' + html.replace(/"/g, '"').replace(/</g, '<').replace(/>/g, '>') + '" style="width:100vw;height:100vh;border:none;"></iframe></body></html>';

                    // Actually, srcdoc won't work well either. Let's create a new blob in the new tab context
                    newTab.document.write('<!DOCTYPE html><html><head><title>' + title + '</title><style>*{margin:0;padding:0;}body,html{height:100%;overflow:hidden;}</style></head><body></body></html>');
                    newTab.document.close();

                    // Create blob in new tab's context
                    var blob = new newTab.Blob([html], { type: 'text/html' });
                    var blobUrl = newTab.URL.createObjectURL(blob);

                    var iframe = newTab.document.createElement('iframe');
                    iframe.style.cssText = 'width:100vw;height:100vh;border:none;position:fixed;top:0;left:0;';
                    iframe.src = blobUrl;
                    newTab.document.body.appendChild(iframe);
                  })
                  .catch(function(err) {
                    console.error('Error loading game for about:blank:', err);
                    newTab.document.write('<h1>Error loading game</h1>');
                    newTab.document.close();
                  });
              } else {
                // Fallback for non-blob URLs
                var html = '<html><head><title>Game</title><style>body,html{margin:0;padding:0;height:100%;overflow:hidden;}</style></head><body><iframe src="' + currentSrc + '" style="width:100vw;height:100vh;border:none;"></iframe></body></html>';
                newTab.document.write(html);
                newTab.document.close();
              }
            } else {
              alert('Popup blocked! Please allow popups for this site.');
            }
          }, true);
        }
      })();
      </script>

</body>

</html>