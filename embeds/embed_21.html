<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>Polar OS</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #14141f;
            --bg-tertiary: #1e1e2e;
            --bg-elevated: #252535;
            --accent: #6366f1;
            --accent-light: #818cf8;
            --accent-dark: #4f46e5;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: rgba(255, 255, 255, 0.08);
            --border-light: rgba(255, 255, 255, 0.12);
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
            --glass: rgba(20, 20, 31, 0.85);
            --glass-border: rgba(255, 255, 255, 0.1);
            --shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            --shadow-lg: 0 35px 60px -15px rgba(0, 0, 0, 0.6);
        }

        .light-theme {
            --bg-primary: #f1f5f9;
            --bg-secondary: #e2e8f0;
            --bg-tertiary: #ffffff;
            --bg-elevated: #ffffff;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --border: rgba(0, 0, 0, 0.08);
            --border-light: rgba(0, 0, 0, 0.12);
            --glass: rgba(255, 255, 255, 0.9);
            --glass-border: rgba(0, 0, 0, 0.1);
            --shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
            --shadow-lg: 0 35px 60px -15px rgba(0, 0, 0, 0.2);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            touch-action: manipulation;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: background 0.3s ease, color 0.3s ease;
        }

        /* ==================== LOGIN SCREEN ==================== */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f0f1a 0%, #1a1a2e 50%, #16213e 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            transition: opacity 0.5s ease, transform 0.5s ease;
        }

        .login-screen.hidden {
            opacity: 0;
            transform: scale(1.1);
            pointer-events: none;
        }

        .login-container {
            background: var(--glass);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 48px 40px;
            width: 90%;
            max-width: 380px;
            box-shadow: var(--shadow-lg), 0 0 100px rgba(99, 102, 241, 0.1);
            animation: loginAppear 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes loginAppear {
            from {
                transform: translateY(30px) scale(0.95);
                opacity: 0;
            }
            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .login-logo {
            text-align: center;
            margin-bottom: 32px;
        }

        .login-logo-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid var(--accent);
            margin: 0 auto 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.2) 0%, rgba(99, 102, 241, 0.05) 100%);
            box-shadow: 0 0 40px rgba(99, 102, 241, 0.3);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 40px rgba(99, 102, 241, 0.3); }
            50% { box-shadow: 0 0 60px rgba(99, 102, 241, 0.5); }
        }

        .login-logo-circle svg {
            width: 40px;
            height: 40px;
            color: var(--accent);
        }

        .login-logo h1 {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            letter-spacing: -0.5px;
        }

        .login-logo p {
            font-size: 14px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .login-input-group {
            position: relative;
        }

        .login-input-group label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .login-input-group input {
            width: 100%;
            padding: 14px 16px;
            background: var(--bg-tertiary);
            border: 2px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 15px;
            font-family: inherit;
            outline: none;
            transition: all 0.2s ease;
        }

        .login-input-group input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.15);
        }

        .login-input-group input::placeholder {
            color: var(--text-muted);
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-dark) 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 8px;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
        }

        .login-btn:active {
            transform: translateY(0);
        }

        .login-error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.3);
            border-radius: 10px;
            padding: 12px 16px;
            color: #ef4444;
            font-size: 13px;
            display: none;
            animation: shake 0.4s ease;
        }

        .login-error.active {
            display: block;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-8px); }
            40%, 80% { transform: translateX(8px); }
        }

        .login-hint {
            text-align: center;
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 20px;
        }

        /* ==================== DESKTOP ==================== */
        .desktop {
            width: 100%;
            height: 100%;
            position: relative;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            background-size: cover;
            background-position: center;
            display: none;
        }

        .desktop.active {
            display: block;
        }

        .desktop.wallpaper-1 {
            background: url('https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?w=1920') center/cover;
        }

        .desktop.wallpaper-2 {
            background: url('https://images.unsplash.com/photo-1507400492013-162706c8c05e?w=1920') center/cover;
        }

        .desktop.wallpaper-3 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        /* ==================== DESKTOP ICONS ==================== */
        .desktop-icons {
            position: absolute;
            top: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            z-index: 5;
        }

        .desktop-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 10px 12px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 80px;
            user-select: none;
        }

        .desktop-icon:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .desktop-icon:active {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(0.95);
        }

        .desktop-icon img {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            object-fit: contain;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .desktop-icon svg {
            width: 48px;
            height: 48px;
            color: var(--text-primary);
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .desktop-icon span {
            font-size: 11px;
            font-weight: 500;
            color: white;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8), 0 0 8px rgba(0, 0, 0, 0.5);
            text-align: center;
            max-width: 70px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        @media (max-width: 768px) {
            .desktop-icons {
                top: 15px;
                left: 15px;
                gap: 6px;
            }

            .desktop-icon {
                width: 70px;
                padding: 8px 10px;
            }

            .desktop-icon img {
                width: 42px;
                height: 42px;
            }

            .desktop-icon svg {
                width: 42px;
                height: 42px;
            }

            .desktop-icon span {
                font-size: 10px;
            }
        }

        /* ==================== WINDOW SYSTEM ==================== */
        .window {
            position: absolute;
            background: var(--glass);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            box-shadow: var(--shadow-lg);
            display: none;
            flex-direction: column;
            overflow: hidden;
            min-width: 320px;
            min-height: 250px;
            transition: transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease;
        }

        .window.active {
            display: flex;
            animation: windowOpen 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .window.minimized {
            transform: scale(0.8) translateY(100px);
            opacity: 0;
            pointer-events: none;
        }

        .window.maximized {
            width: 100% !important;
            height: calc(100% - 70px) !important;
            top: 0 !important;
            left: 0 !important;
            border-radius: 0;
        }

        .window.focused {
            z-index: 100;
            box-shadow: var(--shadow-lg), 0 0 0 2px var(--accent);
        }

        @keyframes windowOpen {
            from {
                transform: scale(0.9);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .window-header {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
            cursor: move;
            user-select: none;
            gap: 12px;
            flex-shrink: 0;
        }

        .window-controls {
            display: flex;
            gap: 8px;
        }

        .window-btn {
            width: 14px;
            height: 14px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: all 0.15s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 8px;
            color: transparent;
        }

        .window-btn:hover {
            color: rgba(0, 0, 0, 0.6);
        }

        .window-btn.close {
            background: #ff5f57;
        }

        .window-btn.minimize {
            background: #febc2e;
        }

        .window-btn.maximize {
            background: #28c840;
        }

        .window-title {
            flex: 1;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
            overflow: hidden;
        }

        .window-title img {
            width: 18px;
            height: 18px;
            border-radius: 4px;
            flex-shrink: 0;
        }

        .window-title span {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .window-content {
            flex: 1;
            overflow: auto;
            background: var(--bg-secondary);
        }

        /* ==================== HOME BAR / TASKBAR ==================== */
        .home-bar {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            width: 100%;
            height: 70px;
            bottom: 0;
            left: 0;
            position: fixed;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 12px;
            z-index: 1000;
            gap: 8px;
            overflow: visible;
        }

        .startup-icon {
            position: absolute;
            left: 12px;
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: transparent;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .startup-icon:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.1);
        }

        .startup-icon:active {
            transform: scale(0.95);
        }

        .startup-circle {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            border: 2px solid var(--text-primary);
            opacity: 0.8;
            transition: opacity 0.2s ease;
        }

        .startup-icon:hover .startup-circle {
            opacity: 1;
        }

        .apps-dock {
            display: flex;
            align-items: center;
            gap: 12px;
            overflow: visible;
            max-width: calc(100% - 240px);
            padding: 0 10px;
        }

        .apps-dock::-webkit-scrollbar {
            display: none;
        }

        .dock-icon {
            width: 46px;
            height: 46px;
            min-width: 46px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            background: transparent;
            touch-action: none;
            z-index: 1;
        }

        .dock-icon:hover {
            transform: translateY(-12px) scale(1.15);
            z-index: 10;
        }

        .dock-icon:active {
            transform: translateY(-4px) scale(1.1);
        }

        .dock-icon.dragging {
            opacity: 0.5;
            transform: scale(1.2);
            z-index: 1000;
        }

        .dock-icon.drag-over {
            transform: translateX(10px);
        }

        .dock-icon img {
            width: 38px;
            height: 38px;
            border-radius: 10px;
            object-fit: contain;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.4));
            pointer-events: none;
        }

        .dock-icon svg {
            width: 26px;
            height: 26px;
            color: var(--text-primary);
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.4));
            pointer-events: none;
        }

        .dock-icon.running::after {
            content: '';
            position: absolute;
            bottom: -4px;
            width: 5px;
            height: 5px;
            background: var(--accent);
            border-radius: 50%;
            box-shadow: 0 0 6px var(--accent);
        }

        .nav-group {
            position: absolute;
            right: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            flex-shrink: 0;
        }

        .nav-section {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.08);
            border-radius: 10px;
        }

        .nav-date, .nav-time {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-primary);
            white-space: nowrap;
        }

        .wifi-indicator {
            display: flex;
            gap: 2px;
            align-items: flex-end;
        }

        .wifi-bar {
            width: 3px;
            background: var(--text-muted);
            border-radius: 1px;
            transition: background 0.2s ease;
        }

        .wifi-bar.active {
            background: var(--text-primary);
        }

        .wifi-bar:nth-child(1) { height: 5px; }
        .wifi-bar:nth-child(2) { height: 8px; }
        .wifi-bar:nth-child(3) { height: 11px; }
        .wifi-bar:nth-child(4) { height: 14px; }

        .battery {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .battery-icon {
            width: 22px;
            height: 11px;
            border: 2px solid var(--text-primary);
            border-radius: 3px;
            position: relative;
            display: flex;
            align-items: center;
            padding: 1px;
        }

        .battery-icon::after {
            content: '';
            position: absolute;
            right: -4px;
            width: 3px;
            height: 5px;
            background: var(--text-primary);
            border-radius: 0 2px 2px 0;
        }

        .battery-level {
            height: 100%;
            background: var(--success);
            border-radius: 1px;
            transition: width 0.3s ease, background 0.3s ease;
        }

        .battery-text {
            font-size: 11px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        /* ==================== MOBILE RESPONSIVE ==================== */
        @media (max-width: 768px) {
            .home-bar {
                height: 64px;
                padding: 0 8px;
            }

            .apps-dock {
                max-width: calc(100% - 180px);
                gap: 10px;
            }

            .startup-icon {
                left: 8px;
                width: 40px;
                height: 40px;
            }

            .startup-circle {
                width: 18px;
                height: 18px;
            }

            .nav-group {
                right: 8px;
            }

            .dock-icon {
                width: 42px;
                height: 42px;
                min-width: 42px;
            }

            .dock-icon img {
                width: 34px;
                height: 34px;
            }

            .dock-icon svg {
                width: 22px;
                height: 22px;
            }

            .nav-section {
                padding: 6px 8px;
                gap: 6px;
            }

            .nav-date {
                display: none;
            }

            .nav-time {
                font-size: 11px;
            }

            .battery-text {
                display: none;
            }

            .wifi-indicator {
                display: none;
            }

            /* Mobile window adjustments */
            .window {
                min-width: 100% !important;
                min-height: 100% !important;
                width: 100% !important;
                height: calc(100% - 64px) !important;
                top: 0 !important;
                left: 0 !important;
                border-radius: 0 !important;
            }

            .window-header {
                padding: 10px 12px;
            }

            .resize-handle {
                display: none;
            }
        }

        @media (max-width: 480px) {
            .home-bar {
                height: 60px;
            }

            .apps-dock {
                max-width: calc(100% - 140px);
                gap: 8px;
            }

            .startup-icon {
                left: 6px;
                width: 36px;
                height: 36px;
            }

            .nav-group {
                right: 6px;
            }

            .dock-icon {
                width: 38px;
                height: 38px;
                min-width: 38px;
            }

            .dock-icon img {
                width: 30px;
                height: 30px;
            }

            .dock-icon svg {
                width: 20px;
                height: 20px;
            }

            .nav-section {
                padding: 5px 6px;
            }

            .window {
                height: calc(100% - 60px) !important;
            }

            .login-container {
                padding: 32px 24px;
            }

            .login-logo h1 {
                font-size: 24px;
            }

            .login-logo-circle {
                width: 64px;
                height: 64px;
            }

            .login-logo-circle svg {
                width: 32px;
                height: 32px;
            }
        }

        /* ==================== APP LAUNCHER ==================== */
        .app-launcher {
            position: fixed;
            bottom: 76px;
            left: 10px;
            width: 380px;
            max-width: calc(100% - 20px);
            max-height: calc(100vh - 100px);
            background: var(--glass);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            box-shadow: var(--shadow-lg);
            display: none;
            flex-direction: column;
            overflow: hidden;
            z-index: 999;
            animation: launcherOpen 0.25s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .app-launcher.active {
            display: flex;
        }

        @keyframes launcherOpen {
            from {
                transform: translateY(20px) scale(0.95);
                opacity: 0;
            }
            to {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .launcher-search {
            padding: 16px;
            border-bottom: 1px solid var(--border);
        }

        .launcher-search input {
            width: 100%;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 14px;
            font-family: inherit;
            outline: none;
            transition: all 0.2s ease;
        }

        .launcher-search input:focus {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.15);
        }

        .launcher-search input::placeholder {
            color: var(--text-muted);
        }

        .launcher-apps {
            padding: 16px;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            overflow-y: auto;
            max-height: 400px;
        }

        @media (max-width: 480px) {
            .launcher-apps {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .launcher-app {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 12px 8px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .launcher-app:hover {
            background: var(--bg-tertiary);
        }

        .launcher-app img {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            object-fit: contain;
        }

        .launcher-app svg {
            width: 48px;
            height: 48px;
            color: var(--text-primary);
        }

        .launcher-app span {
            font-size: 11px;
            font-weight: 500;
            color: var(--text-secondary);
            text-align: center;
            max-width: 70px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .launcher-app:hover span {
            color: var(--text-primary);
        }

        /* ==================== BROWSER STYLES ==================== */
        .browser-nav {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 12px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
            flex-wrap: wrap;
        }

        .browser-btn {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.15s ease;
            flex-shrink: 0;
        }

        .browser-btn:hover:not(:disabled) {
            background: var(--bg-elevated);
            color: var(--text-primary);
        }

        .browser-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .browser-btn svg {
            width: 16px;
            height: 16px;
        }

        .browser-url-bar {
            flex: 1;
            min-width: 150px;
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 0 12px;
            transition: all 0.2s ease;
        }

        .browser-url-bar:focus-within {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .browser-url-bar input {
            flex: 1;
            padding: 10px 0;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 13px;
            font-family: inherit;
            outline: none;
            min-width: 0;
        }

        .browser-url-bar input::placeholder {
            color: var(--text-muted);
        }

        .browser-go-btn {
            padding: 8px 16px;
            background: var(--accent);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 13px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
        }

        .browser-go-btn:hover {
            background: var(--accent-light);
        }

        .browser-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-secondary);
        }

        .browser-homepage {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
            gap: 24px;
        }

        .browser-logo {
            font-size: 42px;
            font-weight: 700;
            color: white;
            background-clip: text;
        }

        .browser-search-box {
            width: 100%;
            max-width: 500px;
            display: flex;
            align-items: center;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 28px;
            padding: 4px;
            transition: all 0.2s ease;
        }

        .browser-search-box:focus-within {
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .browser-search-box input {
            flex: 1;
            padding: 14px 20px;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 15px;
            font-family: inherit;
            outline: none;
            min-width: 0;
        }

        .browser-search-box input::placeholder {
            color: var(--text-muted);
        }

        .browser-search-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: none;
            background: var(--accent);
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .browser-search-btn:hover {
            background: var(--accent-light);
            transform: scale(1.05);
        }

        .browser-loading {
            flex: 1;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 16px;
        }

        .browser-loading.active {
            display: flex;
        }

        .browser-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .browser-error {
            flex: 1;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 16px;
            padding: 40px;
        }

        .browser-error.active {
            display: flex;
        }

        .browser-error h3 {
            font-size: 18px;
            color: var(--text-primary);
        }

        .browser-error p {
            color: var(--text-secondary);
            font-size: 14px;
            text-align: center;
        }

        .browser-retry-btn {
            padding: 10px 24px;
            background: var(--accent);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .browser-retry-btn:hover {
            background: var(--accent-light);
        }

        .browser-frame {
            flex: 1;
            border: none;
            display: none;
            background: white;
            width: 100%;
            height: 100%;
        }

        .browser-frame.active {
            display: block;
        }

        .browser-status {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 6px 12px;
            background: var(--bg-tertiary);
            border-top: 1px solid var(--border);
            font-size: 11px;
            color: var(--text-muted);
        }

        .browser-status-left {
            display: flex;
            align-items: center;
            gap: 6px;
            overflow: hidden;
        }

        .browser-status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--text-muted);
            flex-shrink: 0;
        }

        .browser-status-dot.connected {
            background: var(--success);
        }

        #browserStatusText {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* ==================== CALCULATOR STYLES ==================== */
        .calculator {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .calc-display {
            padding: 24px;
            background: var(--bg-tertiary);
            text-align: right;
        }

        .calc-expression {
            font-size: 14px;
            color: var(--text-muted);
            height: 20px;
            overflow: hidden;
            text-overflow: ellipsis;
            font-family: 'JetBrains Mono', monospace;
        }

        .calc-result {
            font-size: 38px;
            font-weight: 600;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .calc-buttons {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1px;
            background: var(--border);
            padding: 1px;
        }

        .calc-btn {
            border: none;
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 20px;
            font-weight: 500;
            font-family: 'Plus Jakarta Sans', sans-serif;
            cursor: pointer;
            transition: all 0.15s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 60px;
        }

        .calc-btn:hover {
            background: var(--bg-tertiary);
        }

        .calc-btn:active {
            background: var(--bg-elevated);
        }

        .calc-btn.operator {
            background: var(--bg-tertiary);
            color: var(--accent);
        }

        .calc-btn.operator:hover {
            background: var(--bg-elevated);
        }

        .calc-btn.equals {
            background: var(--accent);
            color: white;
        }

        .calc-btn.equals:hover {
            background: var(--accent-light);
        }

        .calc-btn.clear {
            color: var(--danger);
        }

        /* ==================== TERMINAL STYLES ==================== */
        .terminal {
            display: flex;
            flex-direction: column;
            height: 100%;
            background: #0d0d0d;
        }

        .terminal-content {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            line-height: 1.6;
        }

        .terminal-line {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 4px;
        }

        .terminal-prompt {
            color: #22c55e;
            margin-right: 8px;
            white-space: nowrap;
        }

        .terminal-command {
            color: #f8fafc;
        }

        .terminal-output {
            color: #94a3b8;
            white-space: pre-wrap;
            word-break: break-all;
        }

        .terminal-error {
            color: #ef4444;
        }

        .terminal-input-line {
            display: flex;
            align-items: center;
            padding: 8px 16px;
            background: #141414;
            border-top: 1px solid #222;
        }

        .terminal-input-prompt {
            color: #22c55e;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            margin-right: 8px;
            white-space: nowrap;
        }

        .terminal-input {
            flex: 1;
            background: transparent;
            border: none;
            color: #f8fafc;
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            outline: none;
            min-width: 0;
        }

        .terminal-input::placeholder {
            color: #4a5568;
        }

        /* ==================== SETTINGS STYLES ==================== */
        .settings {
            display: flex;
            height: 100%;
        }

        .settings-sidebar {
            width: 200px;
            min-width: 200px;
            background: var(--bg-tertiary);
            border-right: 1px solid var(--border);
            padding: 16px 8px;
            overflow-y: auto;
        }

        .settings-nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 14px;
            border-radius: 10px;
            cursor: pointer;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .settings-nav-item:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
        }

        .settings-nav-item.active {
            background: var(--accent);
            color: white;
        }

        .settings-nav-item svg {
            width: 18px;
            height: 18px;
            flex-shrink: 0;
        }

        .settings-content {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
        }

        .settings-section {
            margin-bottom: 32px;
        }

        .settings-section h2 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 16px;
            color: var(--text-primary);
        }

        .settings-card {
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 4px;
        }

        .settings-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px;
            border-radius: 8px;
            transition: background 0.2s ease;
            gap: 16px;
        }

        .settings-item:hover {
            background: var(--bg-elevated);
        }

        .settings-item-info h3 {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .settings-item-info p {
            font-size: 12px;
            color: var(--text-muted);
        }

        .toggle-switch {
            position: relative;
            width: 48px;
            min-width: 48px;
            height: 28px;
            background: var(--bg-elevated);
            border-radius: 14px;
            cursor: pointer;
            transition: background 0.2s ease;
        }

        .toggle-switch.active {
            background: var(--accent);
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 22px;
            height: 22px;
            background: white;
            border-radius: 50%;
            top: 3px;
            left: 3px;
            transition: transform 0.2s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch.active::after {
            transform: translateX(20px);
        }

        .theme-options {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .theme-option {
            width: 100px;
            padding: 12px;
            border-radius: 12px;
            border: 2px solid var(--border);
            background: var(--bg-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
        }

        .theme-option:hover {
            border-color: var(--accent);
        }

        .theme-option.active {
            border-color: var(--accent);
            background: rgba(99, 102, 241, 0.1);
        }

        .theme-preview {
            width: 100%;
            height: 50px;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .theme-preview.dark {
            background: linear-gradient(135deg, #0a0a0f 0%, #14141f 100%);
        }

        .theme-preview.light {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
        }

        .theme-option span {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .theme-option.active span {
            color: var(--accent);
        }

        .wallpaper-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 12px;
        }

        .wallpaper-option {
            aspect-ratio: 16/9;
            border-radius: 10px;
            border: 2px solid var(--border);
            cursor: pointer;
            transition: all 0.2s ease;
            background-size: cover;
            background-position: center;
        }

        .wallpaper-option:hover {
            border-color: var(--accent);
            transform: scale(1.02);
        }

        .wallpaper-option.active {
            border-color: var(--accent);
            box-shadow: 0 0 0 2px var(--accent);
        }

        .wallpaper-option.w1 {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
        }

        .wallpaper-option.w2 {
            background-image: url('https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?w=400');
        }

        .wallpaper-option.w3 {
            background-image: url('https://images.unsplash.com/photo-1507400492013-162706c8c05e?w=400');
        }

        .wallpaper-option.w4 {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        @media (max-width: 600px) {
            .settings {
                flex-direction: column;
            }

            .settings-sidebar {
                width: 100%;
                min-width: 100%;
                border-right: none;
                border-bottom: 1px solid var(--border);
                padding: 12px;
                display: flex;
                overflow-x: auto;
                overflow-y: hidden;
            }

            .settings-nav-item {
                padding: 10px 12px;
                white-space: nowrap;
            }

            .settings-content {
                padding: 16px;
            }
        }

        /* ==================== FILES APP ==================== */
        .files-app {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .files-toolbar {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            background: var(--bg-tertiary);
            border-bottom: 1px solid var(--border);
        }

        .files-path {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: var(--bg-secondary);
            border-radius: 8px;
            font-size: 13px;
            color: var(--text-secondary);
            overflow: hidden;
        }

        .files-content {
            flex: 1;
            padding: 16px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
            gap: 12px;
            align-content: start;
            overflow-y: auto;
        }

        .file-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 16px 8px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .file-item:hover {
            background: var(--bg-tertiary);
        }

        .file-item svg {
            width: 44px;
            height: 44px;
            color: var(--accent);
        }

        .file-item span {
            font-size: 12px;
            color: var(--text-secondary);
            text-align: center;
            max-width: 80px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* ==================== CONTEXT MENU ==================== */
        .context-menu {
            position: fixed;
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 6px;
            min-width: 180px;
            display: none;
            z-index: 9999;
        }

        .context-menu.active {
            display: block;
            animation: contextOpen 0.15s ease;
        }

        @keyframes contextOpen {
            from {
                transform: scale(0.95);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .context-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            color: var(--text-secondary);
            transition: all 0.15s ease;
        }

        .context-item:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .context-item svg {
            width: 16px;
            height: 16px;
        }

        .context-divider {
            height: 1px;
            background: var(--border);
            margin: 4px 8px;
        }

        /* ==================== RESIZE HANDLE ==================== */
        .resize-handle {
            position: absolute;
            right: 0;
            bottom: 0;
            width: 20px;
            height: 20px;
            cursor: nwse-resize;
        }

        .resize-handle::after {
            content: '';
            position: absolute;
            right: 4px;
            bottom: 4px;
            width: 10px;
            height: 10px;
            border-right: 2px solid var(--text-muted);
            border-bottom: 2px solid var(--text-muted);
            opacity: 0.5;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-screen" id="loginScreen">
        <div class="login-container">
            <div class="login-logo">
                <div class="login-logo-circle">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 6v6l4 2"/>
                    </svg>
                </div>
                <h1>Polar OS</h1>
                <p>Sign in to continue</p>
            </div>
            <form class="login-form" id="loginForm">
                <div class="login-error" id="loginError">
                    Invalid username or password. Please try again.
                </div>
                <div class="login-input-group">
                    <label for="loginUsername">Username</label>
                    <input type="text" id="loginUsername" placeholder="Enter username" autocomplete="username" autofocus>
                </div>
                <div class="login-input-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter password" autocomplete="current-password">
                </div>
                <button type="submit" class="login-btn">Sign In</button>
            </form>
            <p class="login-hint">Hint: username and password are both "polar"</p>
        </div>
    </div>

    <div class="desktop wallpaper-1" id="desktop">
        <!-- Desktop Icons -->
        <div class="desktop-icons">
            <div class="desktop-icon" ondblclick="openApp('browserWindow')">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Google_Chrome_icon_%28February_2022%29.svg/2048px-Google_Chrome_icon_%28February_2022%29.svg.png" alt="Chrome">
                <span>Browser</span>
            </div>
            <div class="desktop-icon" ondblclick="openApp('terminalWindow')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>
                <span>Terminal</span>
            </div>
            <div class="desktop-icon" ondblclick="openApp('filesWindow')">
                <img src="https://chromeunboxed.com/wp-content/uploads/2020/09/649jz8x7fup51.png" alt="Files">
                <span>Files</span>
            </div>
            <div class="desktop-icon" ondblclick="openApp('calculatorWindow')">
                <img src="https://upload.wikimedia.org/wikipedia/commons/2/2a/Android_Calculator_Icon.png" alt="Calculator">
                <span>Calculator</span>
            </div>
            <div class="desktop-icon" ondblclick="openApp('settingsWindow')">
                <img src="https://chromeunboxed.com/wp-content/uploads/2020/09/yzpozgx7fup51.png" alt="Settings">
                <span>Settings</span>
            </div>
        </div>

        <!-- Browser Window -->
        <div class="window" id="browserWindow" style="width: 900px; height: 600px; top: 50px; left: 100px;">
            <div class="window-header">
                <div class="window-controls">
                    <button class="window-btn close" onclick="closeWindow('browserWindow')"></button>
                    <button class="window-btn minimize" onclick="minimizeWindow('browserWindow')"></button>
                    <button class="window-btn maximize" onclick="toggleMaximize('browserWindow')">+</button>
                </div>
                <div class="window-title">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Google_Chrome_icon_%28February_2022%29.svg/2048px-Google_Chrome_icon_%28February_2022%29.svg.png" alt="Chrome">
                    <span>Polar Browser</span>
                </div>
            </div>
            <div class="browser-nav">
                <button class="browser-btn" id="browserBack" disabled>
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                </button>
                <button class="browser-btn" id="browserForward" disabled>
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                </button>
                <button class="browser-btn" id="browserRefresh">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
                </button>
                <div class="browser-url-bar">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"/></svg>
                    <input type="text" id="browserUrl" placeholder="Search or enter URL...">
                </div>
                <button class="browser-go-btn" id="browserGo">Go</button>
            </div>
            <div class="window-content browser-content">
                <div class="browser-homepage" id="browserHomepage">
                    <div class="browser-logo">Polar</div>
                    <div class="browser-search-box">
                        <input type="text" id="browserSearch" placeholder="Search the web or enter URL">
                        <button class="browser-search-btn" id="browserSearchBtn"></button>
                    </div>
                </div>
                <div class="browser-loading" id="browserLoading">
                    <div class="browser-spinner"></div>
                    <span style="color: var(--text-secondary);">Loading...</span>
                </div>
                <div class="browser-error" id="browserError">
                    <h3>Connection Failed</h3>
                    <p id="browserErrorMsg">Unable to load the page.</p>
                    <button class="browser-retry-btn" id="browserRetry">Try Again</button>
                </div>
                <embed class="browser-frame" id="browserFrame" type="text/html">
            </div>
            <div class="browser-status">
                <div class="browser-status-left">
                    <div class="browser-status-dot" id="browserStatusDot"></div>
                    <span id="browserStatusText">Ready</span>
                </div>
                <span>Polar Browser</span>
            </div>
            <div class="resize-handle" onmousedown="startResize(event, 'browserWindow')"></div>
        </div>

        <!-- Calculator Window -->
        <div class="window" id="calculatorWindow" style="width: 340px; height: 500px; top: 100px; left: 200px;">
            <div class="window-header">
                <div class="window-controls">
                    <button class="window-btn close" onclick="closeWindow('calculatorWindow')"></button>
                    <button class="window-btn minimize" onclick="minimizeWindow('calculatorWindow')"></button>
                    <button class="window-btn maximize" onclick="toggleMaximize('calculatorWindow')">+</button>
                </div>
                <div class="window-title">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/2/2a/Android_Calculator_Icon.png" alt="Calculator">
                    <span>Calculator</span>
                </div>
            </div>
            <div class="window-content">
                <div class="calculator">
                    <div class="calc-display">
                        <div class="calc-expression" id="calcExpression"></div>
                        <div class="calc-result" id="calcResult">0</div>
                    </div>
                    <div class="calc-buttons">
                        <button class="calc-btn clear" onclick="calcClear()">C</button>
                        <button class="calc-btn operator" onclick="calcInput('(')">(</button>
                        <button class="calc-btn operator" onclick="calcInput(')')">)</button>
                        <button class="calc-btn operator" onclick="calcInput('/')"></button>
                        <button class="calc-btn" onclick="calcInput('7')">7</button>
                        <button class="calc-btn" onclick="calcInput('8')">8</button>
                        <button class="calc-btn" onclick="calcInput('9')">9</button>
                        <button class="calc-btn operator" onclick="calcInput('*')"></button>
                        <button class="calc-btn" onclick="calcInput('4')">4</button>
                        <button class="calc-btn" onclick="calcInput('5')">5</button>
                        <button class="calc-btn" onclick="calcInput('6')">6</button>
                        <button class="calc-btn operator" onclick="calcInput('-')"></button>
                        <button class="calc-btn" onclick="calcInput('1')">1</button>
                        <button class="calc-btn" onclick="calcInput('2')">2</button>
                        <button class="calc-btn" onclick="calcInput('3')">3</button>
                        <button class="calc-btn operator" onclick="calcInput('+')">+</button>
                        <button class="calc-btn" onclick="calcInput('0')">0</button>
                        <button class="calc-btn" onclick="calcInput('.')">.</button>
                        <button class="calc-btn operator" onclick="calcBackspace()"></button>
                        <button class="calc-btn equals" onclick="calcEquals()">=</button>
                    </div>
                </div>
            </div>
            <div class="resize-handle" onmousedown="startResize(event, 'calculatorWindow')"></div>
        </div>

        <!-- Terminal Window -->
        <div class="window" id="terminalWindow" style="width: 700px; height: 450px; top: 80px; left: 150px;">
            <div class="window-header">
                <div class="window-controls">
                    <button class="window-btn close" onclick="closeWindow('terminalWindow')"></button>
                    <button class="window-btn minimize" onclick="minimizeWindow('terminalWindow')"></button>
                    <button class="window-btn maximize" onclick="toggleMaximize('terminalWindow')">+</button>
                </div>
                <div class="window-title">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>
                    <span>Terminal</span>
                </div>
            </div>
            <div class="window-content">
                <div class="terminal">
                    <div class="terminal-content" id="terminalContent">
                        <div class="terminal-line">
                            <span class="terminal-output">Polar OS Terminal v1.0.0</span>
                        </div>
                        <div class="terminal-line">
                            <span class="terminal-output">Type 'help' for available commands.</span>
                        </div>
                        <div class="terminal-line">
                            <span class="terminal-output"></span>
                        </div>
                    </div>
                    <div class="terminal-input-line">
                        <span class="terminal-input-prompt">user@polar:~$</span>
                        <input type="text" class="terminal-input" id="terminalInput" placeholder="Enter command..." autocomplete="off" spellcheck="false">
                    </div>
                </div>
            </div>
            <div class="resize-handle" onmousedown="startResize(event, 'terminalWindow')"></div>
        </div>

        <!-- Settings Window -->
        <div class="window" id="settingsWindow" style="width: 800px; height: 550px; top: 80px; left: 250px;">
            <div class="window-header">
                <div class="window-controls">
                    <button class="window-btn close" onclick="closeWindow('settingsWindow')"></button>
                    <button class="window-btn minimize" onclick="minimizeWindow('settingsWindow')"></button>
                    <button class="window-btn maximize" onclick="toggleMaximize('settingsWindow')">+</button>
                </div>
                <div class="window-title">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><circle cx="12" cy="12" r="3"/></svg>
                    <span>Settings</span>
                </div>
            </div>
            <div class="window-content">
                <div class="settings">
                    <div class="settings-sidebar">
                        <div class="settings-nav-item active" data-section="appearance">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"/></svg>
                            Appearance
                        </div>
                        <div class="settings-nav-item" data-section="display">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
                            Display
                        </div>
                        <div class="settings-nav-item" data-section="sound">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z"/></svg>
                            Sound
                        </div>
                        <div class="settings-nav-item" data-section="network">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.111 16.404a5.5 5.5 0 017.778 0M12 20h.01m-7.08-7.071c3.904-3.905 10.236-3.905 14.141 0M1.394 9.393c5.857-5.857 15.355-5.857 21.213 0"/></svg>
                            Network
                        </div>
                        <div class="settings-nav-item" data-section="about">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
                            About
                        </div>
                    </div>
                    <div class="settings-content">
                        <div class="settings-section" id="settingsAppearance">
                            <h2>Theme</h2>
                            <div class="theme-options">
                                <div class="theme-option active" data-theme="dark">
                                    <div class="theme-preview dark"></div>
                                    <span>Dark</span>
                                </div>
                                <div class="theme-option" data-theme="light">
                                    <div class="theme-preview light"></div>
                                    <span>Light</span>
                                </div>
                            </div>
                        </div>
                        <div class="settings-section">
                            <h2>Wallpaper</h2>
                            <div class="wallpaper-options">
                                <div class="wallpaper-option w1" data-wallpaper="default"></div>
                                <div class="wallpaper-option w2 active" data-wallpaper="wallpaper-1"></div>
                                <div class="wallpaper-option w3" data-wallpaper="wallpaper-2"></div>
                                <div class="wallpaper-option w4" data-wallpaper="wallpaper-3"></div>
                            </div>
                        </div>
                        <div class="settings-section">
                            <h2>Taskbar</h2>
                            <div class="settings-card">
                                <div class="settings-item">
                                    <div class="settings-item-info">
                                        <h3>Auto-hide taskbar</h3>
                                        <p>Automatically hide the taskbar when not in use</p>
                                    </div>
                                    <div class="toggle-switch" id="toggleAutohide"></div>
                                </div>
                                <div class="settings-item">
                                    <div class="settings-item-info">
                                        <h3>Show app badges</h3>
                                        <p>Display notification badges on app icons</p>
                                    </div>
                                    <div class="toggle-switch active" id="toggleBadges"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="resize-handle" onmousedown="startResize(event, 'settingsWindow')"></div>
        </div>

        <!-- Files Window -->
        <div class="window" id="filesWindow" style="width: 700px; height: 450px; top: 120px; left: 300px;">
            <div class="window-header">
                <div class="window-controls">
                    <button class="window-btn close" onclick="closeWindow('filesWindow')"></button>
                    <button class="window-btn minimize" onclick="minimizeWindow('filesWindow')"></button>
                    <button class="window-btn maximize" onclick="toggleMaximize('filesWindow')">+</button>
                </div>
                <div class="window-title">
                    <img src="https://chromeunboxed.com/wp-content/uploads/2020/09/649jz8x7fup51.png" alt="Files">
                    <span>Files</span>
                </div>
            </div>
            <div class="window-content">
                <div class="files-app">
                    <div class="files-toolbar">
                        <button class="browser-btn">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                        </button>
                        <button class="browser-btn">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                        </button>
                        <div class="files-path">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
                            Home
                        </div>
                    </div>
                    <div class="files-content">
                        <div class="file-item">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/></svg>
                            <span>Documents</span>
                        </div>
                        <div class="file-item">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/></svg>
                            <span>Downloads</span>
                        </div>
                        <div class="file-item">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/></svg>
                            <span>Pictures</span>
                        </div>
                        <div class="file-item">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/></svg>
                            <span>Music</span>
                        </div>
                        <div class="file-item">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/></svg>
                            <span>Videos</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="resize-handle" onmousedown="startResize(event, 'filesWindow')"></div>
        </div>

        <!-- App Launcher -->
        <div class="app-launcher" id="appLauncher">
            <div class="launcher-search">
                <input type="text" id="launcherSearch" placeholder="Search apps...">
            </div>
            <div class="launcher-apps" id="launcherApps">
                <div class="launcher-app" onclick="openApp('browserWindow')">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Google_Chrome_icon_%28February_2022%29.svg/2048px-Google_Chrome_icon_%28February_2022%29.svg.png" alt="Chrome">
                    <span>Browser</span>
                </div>
                <div class="launcher-app" onclick="openApp('terminalWindow')">
                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>
                    <span>Terminal</span>
                </div>
                <div class="launcher-app" onclick="openApp('calculatorWindow')">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/2/2a/Android_Calculator_Icon.png" alt="Calculator">
                    <span>Calculator</span>
                </div>
                <div class="launcher-app" onclick="openApp('filesWindow')">
                    <img src="https://chromeunboxed.com/wp-content/uploads/2020/09/649jz8x7fup51.png" alt="Files">
                    <span>Files</span>
                </div>
                <div class="launcher-app" onclick="openApp('settingsWindow')">
                    <img src="https://chromeunboxed.com/wp-content/uploads/2020/09/yzpozgx7fup51.png" alt="Settings">
                    <span>Settings</span>
                </div>
                <div class="launcher-app" onclick="openApp('browserWindow')">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/3c/Google_Favicon_2025.svg/960px-Google_Favicon_2025.svg.png" alt="Google">
                    <span>Google</span>
                </div>
                <div class="launcher-app">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4e/Gmail_Icon.png/1024px-Gmail_Icon.png" alt="Gmail">
                    <span>Gmail</span>
                </div>
                <div class="launcher-app">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/Google_Drive_icon_%282020%29.svg/2295px-Google_Drive_icon_%282020%29.svg.png" alt="Drive">
                    <span>Drive</span>
                </div>
            </div>
        </div>

        <!-- Context Menu -->
        <div class="context-menu" id="contextMenu">
            <div class="context-item" onclick="openApp('browserWindow')">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9"/></svg>
                Open Browser
            </div>
            <div class="context-item" onclick="openApp('terminalWindow')">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>
                Open Terminal
            </div>
            <div class="context-item" onclick="openApp('settingsWindow')">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><circle cx="12" cy="12" r="3"/></svg>
                Settings
            </div>
            <div class="context-divider"></div>
            <div class="context-item" onclick="changeWallpaper()">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/></svg>
                Change Wallpaper
            </div>
            <div class="context-item" onclick="logout()">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/></svg>
                Sign Out
            </div>
        </div>

        <!-- Home Bar -->
        <div class="home-bar">
            <button class="startup-icon" id="startupIcon">
                <div class="startup-circle"></div>
            </button>
            <div class="apps-dock" id="appsDock">
                <div class="dock-icon" data-app="browserWindow" draggable="true" title="Browser">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Google_Chrome_icon_%28February_2022%29.svg/2048px-Google_Chrome_icon_%28February_2022%29.svg.png" alt="Chrome">
                </div>
                <div class="dock-icon" data-app="terminalWindow" draggable="true" title="Terminal">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="4 17 10 11 4 5"></polyline><line x1="12" y1="19" x2="20" y2="19"></line></svg>
                </div>
                <div class="dock-icon" data-app="filesWindow" draggable="true" title="Files">
                    <img src="https://chromeunboxed.com/wp-content/uploads/2020/09/649jz8x7fup51.png" alt="Files">
                </div>
                <div class="dock-icon" data-app="calculatorWindow" draggable="true" title="Calculator">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/2/2a/Android_Calculator_Icon.png" alt="Calculator">
                </div>
                <div class="dock-icon" data-app="settingsWindow" draggable="true" title="Settings">
                    <img src="https://chromeunboxed.com/wp-content/uploads/2020/09/yzpozgx7fup51.png" alt="Settings">
                </div>
            </div>
            <div class="nav-group">
                <div class="nav-section">
                    <span class="nav-date" id="navDate"></span>
                </div>
                <div class="nav-section">
                    <span class="nav-time" id="navTime"></span>
                    <div class="wifi-indicator">
                        <div class="wifi-bar active"></div>
                        <div class="wifi-bar active"></div>
                        <div class="wifi-bar active"></div>
                        <div class="wifi-bar active"></div>
                    </div>
                    <div class="battery">
                        <div class="battery-icon">
                            <div class="battery-level" id="batteryLevel" style="width: 75%;"></div>
                        </div>
                        <span class="battery-text" id="batteryText">75%</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== APP STATE ====================
        let currentTheme = 'dark';
        let currentWallpaper = 'wallpaper-1';
        let openWindows = new Set();
        let focusedWindow = null;
        let zIndexCounter = 10;
        let isLoggedIn = false;

        // Calculator State
        let calcExpression = '';
        let calcDisplay = '0';

        // Browser State
        let browserUrl = '';
        let browserHistory = [];
        let browserHistoryIndex = -1;

        // Terminal State
        let terminalHistory = [];
        let terminalHistoryIndex = -1;
        let currentDirectory = '~';
        const fileSystem = {
            '~': ['Documents', 'Downloads', 'Pictures', 'Music', 'Videos', '.bashrc', '.profile'],
            '~/Documents': ['readme.txt', 'notes.md', 'project'],
            '~/Downloads': ['image.png', 'setup.exe'],
            '~/Pictures': ['photo1.jpg', 'screenshot.png'],
            '~/Music': ['song.mp3'],
            '~/Videos': ['video.mp4']
        };

        // Drag and Drop State
        let draggedIcon = null;

        // ==================== INITIALIZE ====================
        document.addEventListener('DOMContentLoaded', () => {
            initLogin();
            updateDateTime();
            setInterval(updateDateTime, 1000);
            initBattery();
            initDraggable();
            initEventListeners();
            initTerminal();
            initDockDragAndDrop();
        });

        // ==================== LOGIN SYSTEM ====================
        function initLogin() {
            const loginForm = document.getElementById('loginForm');
            loginForm.addEventListener('submit', handleLogin);
            
            // Check if already logged in (session storage)
            if (sessionStorage.getItem('polarOsLoggedIn') === 'true') {
                login();
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value.trim().toLowerCase();
            const password = document.getElementById('loginPassword').value;
            const errorEl = document.getElementById('loginError');
            
            if (username === 'polar' && password === 'polar') {
                errorEl.classList.remove('active');
                sessionStorage.setItem('polarOsLoggedIn', 'true');
                login();
            } else {
                errorEl.classList.add('active');
                document.getElementById('loginPassword').value = '';
            }
        }

        function login() {
            isLoggedIn = true;
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('desktop').classList.add('active');
        }

        function logout() {
            isLoggedIn = false;
            sessionStorage.removeItem('polarOsLoggedIn');
            
            // Close all windows
            openWindows.forEach(windowId => {
                const win = document.getElementById(windowId);
                if (win) {
                    win.classList.remove('active', 'focused', 'maximized');
                }
            });
            openWindows.clear();
            updateDockIcons();
            
            // Reset form
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
            document.getElementById('loginError').classList.remove('active');
            
            // Show login screen
            document.getElementById('desktop').classList.remove('active');
            document.getElementById('loginScreen').classList.remove('hidden');
            
            hideContextMenu();
            closeLauncher();
        }

        // ==================== DATE/TIME ====================
        function updateDateTime() {
            const now = new Date();
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            document.getElementById('navDate').textContent = `${months[now.getMonth()]} ${now.getDate()}`;
            const h = now.getHours();
            const m = now.getMinutes();
            document.getElementById('navTime').textContent = `${h % 12 || 12}:${String(m).padStart(2, '0')} ${h >= 12 ? 'PM' : 'AM'}`;
        }

        // ==================== BATTERY ====================
        function initBattery() {
            if (navigator.getBattery) {
                navigator.getBattery().then(battery => {
                    updateBattery(battery);
                    battery.addEventListener('levelchange', () => updateBattery(battery));
                    battery.addEventListener('chargingchange', () => updateBattery(battery));
                });
            }
        }

        function updateBattery(battery) {
            const level = Math.round(battery.level * 100);
            const levelEl = document.getElementById('batteryLevel');
            const textEl = document.getElementById('batteryText');
            levelEl.style.width = level + '%';
            textEl.textContent = (battery.charging ? '' : '') + level + '%';
            if (level > 50) levelEl.style.background = 'var(--success)';
            else if (level > 20) levelEl.style.background = 'var(--warning)';
            else levelEl.style.background = 'var(--danger)';
        }

        // ==================== WINDOW MANAGEMENT ====================
        function openApp(windowId) {
            const win = document.getElementById(windowId);
            win.classList.add('active');
            win.classList.remove('minimized');
            openWindows.add(windowId);
            focusWindow(windowId);
            closeLauncher();
            updateDockIcons();
            
            if (windowId === 'terminalWindow') {
                setTimeout(() => document.getElementById('terminalInput').focus(), 100);
            }
        }

        function closeWindow(windowId) {
            const win = document.getElementById(windowId);
            win.classList.remove('active', 'focused', 'maximized');
            openWindows.delete(windowId);
            updateDockIcons();
        }

        function minimizeWindow(windowId) {
            const win = document.getElementById(windowId);
            win.classList.add('minimized');
            win.classList.remove('focused');
        }

        function toggleMaximize(windowId) {
            const win = document.getElementById(windowId);
            win.classList.toggle('maximized');
        }

        function focusWindow(windowId) {
            document.querySelectorAll('.window').forEach(w => w.classList.remove('focused'));
            const win = document.getElementById(windowId);
            win.classList.add('focused');
            win.style.zIndex = ++zIndexCounter;
            focusedWindow = windowId;
        }

        function updateDockIcons() {
            document.querySelectorAll('.apps-dock .dock-icon').forEach(icon => {
                const appId = icon.dataset.app;
                if (appId && openWindows.has(appId)) {
                    icon.classList.add('running');
                } else {
                    icon.classList.remove('running');
                }
            });
        }

        // ==================== DOCK DRAG AND DROP ====================
        function initDockDragAndDrop() {
            const dock = document.getElementById('appsDock');
            const icons = dock.querySelectorAll('.dock-icon');
            
            icons.forEach(icon => {
                // Mouse events
                icon.addEventListener('dragstart', handleDragStart);
                icon.addEventListener('dragend', handleDragEnd);
                icon.addEventListener('dragover', handleDragOver);
                icon.addEventListener('dragenter', handleDragEnter);
                icon.addEventListener('dragleave', handleDragLeave);
                icon.addEventListener('drop', handleDrop);
                
                // Touch events for mobile
                icon.addEventListener('touchstart', handleTouchStart, { passive: false });
                icon.addEventListener('touchmove', handleTouchMove, { passive: false });
                icon.addEventListener('touchend', handleTouchEnd);
                
                // Click event
                icon.addEventListener('click', (e) => {
                    if (!icon.classList.contains('dragging')) {
                        const appId = icon.dataset.app;
                        if (appId) {
                            if (openWindows.has(appId)) {
                                const win = document.getElementById(appId);
                                if (win.classList.contains('minimized')) {
                                    win.classList.remove('minimized');
                                    focusWindow(appId);
                                } else {
                                    minimizeWindow(appId);
                                }
                            } else {
                                openApp(appId);
                            }
                        }
                    }
                });
            });
        }

        function handleDragStart(e) {
            draggedIcon = this;
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', this.innerHTML);
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
            document.querySelectorAll('.dock-icon').forEach(icon => {
                icon.classList.remove('drag-over');
            });
            draggedIcon = null;
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }

        function handleDragEnter(e) {
            if (this !== draggedIcon) {
                this.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            this.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.stopPropagation();
            if (draggedIcon !== this) {
                const dock = document.getElementById('appsDock');
                const icons = [...dock.querySelectorAll('.dock-icon')];
                const draggedIndex = icons.indexOf(draggedIcon);
                const dropIndex = icons.indexOf(this);
                
                if (draggedIndex < dropIndex) {
                    this.parentNode.insertBefore(draggedIcon, this.nextSibling);
                } else {
                    this.parentNode.insertBefore(draggedIcon, this);
                }
            }
            this.classList.remove('drag-over');
            return false;
        }

        // Touch events for mobile drag and drop
        let touchStartX = 0;
        let touchStartY = 0;
        let touchIcon = null;
        let touchTimeout = null;
        let isDraggingTouch = false;

        function handleTouchStart(e) {
            touchIcon = this;
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
            
            touchTimeout = setTimeout(() => {
                isDraggingTouch = true;
                touchIcon.classList.add('dragging');
            }, 300);
        }

        function handleTouchMove(e) {
            if (!isDraggingTouch) {
                const deltaX = Math.abs(e.touches[0].clientX - touchStartX);
                const deltaY = Math.abs(e.touches[0].clientY - touchStartY);
                if (deltaX > 10 || deltaY > 10) {
                    clearTimeout(touchTimeout);
                }
                return;
            }
            
            e.preventDefault();
            
            const touch = e.touches[0];
            const elementBelow = document.elementFromPoint(touch.clientX, touch.clientY);
            const iconBelow = elementBelow?.closest('.dock-icon');
            
            document.querySelectorAll('.dock-icon').forEach(icon => {
                icon.classList.remove('drag-over');
            });
            
            if (iconBelow && iconBelow !== touchIcon) {
                iconBelow.classList.add('drag-over');
            }
        }

        function handleTouchEnd(e) {
            clearTimeout(touchTimeout);
            
            if (isDraggingTouch && touchIcon) {
                const touch = e.changedTouches[0];
                const elementBelow = document.elementFromPoint(touch.clientX, touch.clientY);
                const iconBelow = elementBelow?.closest('.dock-icon');
                
                if (iconBelow && iconBelow !== touchIcon) {
                    const dock = document.getElementById('appsDock');
                    const icons = [...dock.querySelectorAll('.dock-icon')];
                    const draggedIndex = icons.indexOf(touchIcon);
                    const dropIndex = icons.indexOf(iconBelow);
                    
                    if (draggedIndex < dropIndex) {
                        iconBelow.parentNode.insertBefore(touchIcon, iconBelow.nextSibling);
                    } else {
                        iconBelow.parentNode.insertBefore(touchIcon, iconBelow);
                    }
                }
                
                touchIcon.classList.remove('dragging');
                document.querySelectorAll('.dock-icon').forEach(icon => {
                    icon.classList.remove('drag-over');
                });
            }
            
            isDraggingTouch = false;
            touchIcon = null;
        }

        // ==================== DRAGGABLE WINDOWS ====================
        function initDraggable() {
            document.querySelectorAll('.window-header').forEach(header => {
                header.addEventListener('mousedown', startDrag);
                header.addEventListener('touchstart', startDragTouch, { passive: false });
            });
        }

        let dragState = { active: false, windowId: null, offsetX: 0, offsetY: 0 };

        function startDrag(e) {
            if (e.target.classList.contains('window-btn')) return;
            const win = e.target.closest('.window');
            if (win.classList.contains('maximized')) return;
            if (window.innerWidth <= 768) return; // Disable drag on mobile
            
            dragState.active = true;
            dragState.windowId = win.id;
            dragState.offsetX = e.clientX - win.offsetLeft;
            dragState.offsetY = e.clientY - win.offsetTop;
            focusWindow(win.id);
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);
        }

        function startDragTouch(e) {
            if (e.target.classList.contains('window-btn')) return;
            const win = e.target.closest('.window');
            if (win.classList.contains('maximized')) return;
            if (window.innerWidth <= 768) return;
            
            const touch = e.touches[0];
            dragState.active = true;
            dragState.windowId = win.id;
            dragState.offsetX = touch.clientX - win.offsetLeft;
            dragState.offsetY = touch.clientY - win.offsetTop;
            focusWindow(win.id);
            
            document.addEventListener('touchmove', dragTouch, { passive: false });
            document.addEventListener('touchend', stopDragTouch);
        }

        function drag(e) {
            if (!dragState.active) return;
            const win = document.getElementById(dragState.windowId);
            win.style.left = (e.clientX - dragState.offsetX) + 'px';
            win.style.top = (e.clientY - dragState.offsetY) + 'px';
        }

        function dragTouch(e) {
            if (!dragState.active) return;
            e.preventDefault();
            const touch = e.touches[0];
            const win = document.getElementById(dragState.windowId);
            win.style.left = (touch.clientX - dragState.offsetX) + 'px';
            win.style.top = (touch.clientY - dragState.offsetY) + 'px';
        }

        function stopDrag() {
            dragState.active = false;
            document.removeEventListener('mousemove', drag);
            document.removeEventListener('mouseup', stopDrag);
        }

        function stopDragTouch() {
            dragState.active = false;
            document.removeEventListener('touchmove', dragTouch);
            document.removeEventListener('touchend', stopDragTouch);
        }

        // ==================== RESIZE WINDOWS ====================
        let resizeState = { active: false, windowId: null, startX: 0, startY: 0, startW: 0, startH: 0 };

        function startResize(e, windowId) {
            e.preventDefault();
            if (window.innerWidth <= 768) return; // Disable resize on mobile
            
            const win = document.getElementById(windowId);
            if (win.classList.contains('maximized')) return;
            
            resizeState.active = true;
            resizeState.windowId = windowId;
            resizeState.startX = e.clientX;
            resizeState.startY = e.clientY;
            resizeState.startW = win.offsetWidth;
            resizeState.startH = win.offsetHeight;
            
            document.addEventListener('mousemove', resize);
            document.addEventListener('mouseup', stopResize);
        }

        function resize(e) {
            if (!resizeState.active) return;
            const win = document.getElementById(resizeState.windowId);
            const newW = resizeState.startW + (e.clientX - resizeState.startX);
            const newH = resizeState.startH + (e.clientY - resizeState.startY);
            win.style.width = Math.max(320, newW) + 'px';
            win.style.height = Math.max(250, newH) + 'px';
        }

        function stopResize() {
            resizeState.active = false;
            document.removeEventListener('mousemove', resize);
            document.removeEventListener('mouseup', stopResize);
        }

        // ==================== APP LAUNCHER ====================
        function toggleLauncher() {
            const launcher = document.getElementById('appLauncher');
            launcher.classList.toggle('active');
            if (launcher.classList.contains('active')) {
                document.getElementById('launcherSearch').focus();
            }
        }

        function closeLauncher() {
            document.getElementById('appLauncher').classList.remove('active');
        }

        // ==================== CALCULATOR ====================
        function calcInput(value) {
            if (calcDisplay === '0' && !isNaN(value)) {
                calcDisplay = value;
            } else {
                calcDisplay += value;
            }
            calcExpression = calcDisplay;
            document.getElementById('calcResult').textContent = calcDisplay;
        }

        function calcClear() {
            calcDisplay = '0';
            calcExpression = '';
            document.getElementById('calcResult').textContent = '0';
            document.getElementById('calcExpression').textContent = '';
        }

        function calcBackspace() {
            if (calcDisplay.length > 1) {
                calcDisplay = calcDisplay.slice(0, -1);
            } else {
                calcDisplay = '0';
            }
            document.getElementById('calcResult').textContent = calcDisplay;
        }

        function calcEquals() {
            try {
                document.getElementById('calcExpression').textContent = calcDisplay + ' =';
                const result = eval(calcDisplay);
                calcDisplay = String(result);
                document.getElementById('calcResult').textContent = calcDisplay;
            } catch (e) {
                document.getElementById('calcResult').textContent = 'Error';
                calcDisplay = '0';
            }
        }

        // ==================== TERMINAL ====================
        function initTerminal() {
            const input = document.getElementById('terminalInput');
            input.addEventListener('keydown', handleTerminalInput);
        }

        function handleTerminalInput(e) {
            const input = document.getElementById('terminalInput');
            
            if (e.key === 'Enter') {
                const command = input.value.trim();
                if (command) {
                    terminalHistory.push(command);
                    terminalHistoryIndex = terminalHistory.length;
                    executeCommand(command);
                }
                input.value = '';
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                if (terminalHistoryIndex > 0) {
                    terminalHistoryIndex--;
                    input.value = terminalHistory[terminalHistoryIndex];
                }
            } else if (e.key === 'ArrowDown') {
                e.preventDefault();
                if (terminalHistoryIndex < terminalHistory.length - 1) {
                    terminalHistoryIndex++;
                    input.value = terminalHistory[terminalHistoryIndex];
                } else {
                    terminalHistoryIndex = terminalHistory.length;
                    input.value = '';
                }
            }
        }

        function executeCommand(command) {
            const content = document.getElementById('terminalContent');
            const parts = command.split(' ');
            const cmd = parts[0].toLowerCase();
            const args = parts.slice(1);
            
            appendTerminalLine(`user@polar:${currentDirectory}$`, command, 'command');
            
            let output = '';
            let isError = false;
            
            switch (cmd) {
                case 'help':
                    output = `Available commands:
  help          - Show this help message
  clear         - Clear the terminal
  echo [text]   - Print text to terminal
  date          - Show current date and time
  whoami        - Show current user
  pwd           - Print working directory
  ls            - List directory contents
  cd [dir]      - Change directory
  cat [file]    - Display file contents
  mkdir [name]  - Create directory (simulated)
  touch [name]  - Create file (simulated)
  rm [name]     - Remove file (simulated)
  uname         - System information
  uptime        - System uptime
  neofetch      - System info display
  calc [expr]   - Calculate expression
  history       - Show command history
  open [app]    - Open an application
  logout        - Sign out of Polar OS`;
                    break;
                    
                case 'clear':
                    content.innerHTML = '';
                    return;
                    
                case 'echo':
                    output = args.join(' ') || '';
                    break;
                    
                case 'date':
                    output = new Date().toString();
                    break;
                    
                case 'whoami':
                    output = 'polar';
                    break;
                    
                case 'pwd':
                    output = currentDirectory.replace('~', '/home/polar');
                    break;
                    
                case 'ls':
                    const dir = args[0] ? (args[0].startsWith('/') ? args[0] : currentDirectory + '/' + args[0]) : currentDirectory;
                    const files = fileSystem[dir] || fileSystem[currentDirectory];
                    if (files) {
                        output = files.join('  ');
                    } else {
                        output = `ls: cannot access '${args[0]}': No such file or directory`;
                        isError = true;
                    }
                    break;
                    
                case 'cd':
                    if (!args[0] || args[0] === '~') {
                        currentDirectory = '~';
                    } else if (args[0] === '..') {
                        if (currentDirectory !== '~') {
                            currentDirectory = currentDirectory.split('/').slice(0, -1).join('/') || '~';
                        }
                    } else {
                        const newDir = args[0].startsWith('~') ? args[0] : currentDirectory + '/' + args[0];
                        if (fileSystem[newDir]) {
                            currentDirectory = newDir;
                        } else {
                            output = `cd: ${args[0]}: No such file or directory`;
                            isError = true;
                        }
                    }
                    break;
                    
                case 'cat':
                    if (!args[0]) {
                        output = 'cat: missing operand';
                        isError = true;
                    } else if (args[0] === 'readme.txt') {
                        output = 'Welcome to Polar OS!\nThis is a simulated operating system built with HTML, CSS, and JavaScript.';
                    } else if (args[0] === 'notes.md') {
                        output = '# Notes\n- Remember to update the system\n- Check out the new features';
                    } else if (args[0] === '.bashrc') {
                        output = '# ~/.bashrc\nexport PATH=$PATH:/usr/local/bin\nalias ll="ls -la"';
                    } else {
                        output = `cat: ${args[0]}: No such file or directory`;
                        isError = true;
                    }
                    break;
                    
                case 'mkdir':
                    output = args[0] ? `Directory '${args[0]}' created` : 'mkdir: missing operand';
                    isError = !args[0];
                    break;
                    
                case 'touch':
                    output = args[0] ? `File '${args[0]}' created` : 'touch: missing operand';
                    isError = !args[0];
                    break;
                    
                case 'rm':
                    output = args[0] ? `Removed '${args[0]}'` : 'rm: missing operand';
                    isError = !args[0];
                    break;
                    
                case 'uname':
                    if (args[0] === '-a') {
                        output = 'PolarOS 1.0.0 polar-kernel x86_64 GNU/Linux';
                    } else {
                        output = 'PolarOS';
                    }
                    break;
                    
                case 'uptime':
                    const uptime = Math.floor(performance.now() / 1000);
                    const hours = Math.floor(uptime / 3600);
                    const mins = Math.floor((uptime % 3600) / 60);
                    output = `up ${hours} hours, ${mins} minutes`;
                    break;
                    
                case 'neofetch':
                    output = `              polar@polar
            -----------
          OS: Polar OS 1.0
        Host: Web Browser
       Kernel: JavaScript
       Uptime: ${Math.floor(performance.now() / 60000)} mins
       Shell: polar-sh
         Terminal: Polar Terminal
           Theme: ${currentTheme}
       `;
                    break;
                    
                case 'calc':
                    if (args.length === 0) {
                        output = 'Usage: calc [expression]';
                    } else {
                        try {
                            const expr = args.join('');
                            output = String(eval(expr));
                        } catch (e) {
                            output = 'Error: Invalid expression';
                            isError = true;
                        }
                    }
                    break;
                    
                case 'history':
                    output = terminalHistory.map((cmd, i) => `  ${i + 1}  ${cmd}`).join('\n');
                    break;
                    
                case 'open':
                    const appMap = {
                        'browser': 'browserWindow',
                        'chrome': 'browserWindow',
                        'terminal': 'terminalWindow',
                        'files': 'filesWindow',
                        'calculator': 'calculatorWindow',
                        'calc': 'calculatorWindow',
                        'settings': 'settingsWindow'
                    };
                    if (args[0] && appMap[args[0].toLowerCase()]) {
                        openApp(appMap[args[0].toLowerCase()]);
                        output = `Opening ${args[0]}...`;
                    } else {
                        output = `open: ${args[0] || 'app'}: Application not found\nAvailable: browser, terminal, files, calculator, settings`;
                        isError = true;
                    }
                    break;
                    
                case 'logout':
                    logout();
                    output = 'Signing out...';
                    break;
                    
                default:
                    output = `${cmd}: command not found. Type 'help' for available commands.`;
                    isError = true;
            }
            
            if (output) {
                appendTerminalLine('', output, isError ? 'error' : 'output');
            }
            
            content.scrollTop = content.scrollHeight;
        }

        function appendTerminalLine(prompt, text, type) {
            const content = document.getElementById('terminalContent');
            const line = document.createElement('div');
            line.className = 'terminal-line';
            
            if (type === 'command') {
                line.innerHTML = `<span class="terminal-prompt">${prompt}</span><span class="terminal-command">${text}</span>`;
            } else if (type === 'error') {
                line.innerHTML = `<span class="terminal-error">${text}</span>`;
            } else {
                line.innerHTML = `<span class="terminal-output">${text}</span>`;
            }
            
            content.appendChild(line);
        }

        // ==================== BROWSER ====================
        function browserNavigate(url) {
            if (!url) url = document.getElementById('browserUrl').value.trim();
            if (!url) return;
            
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                if (url.includes('.') && !url.includes(' ')) {
                    url = 'https://' + url;
                } else {
                    url = 'https://www.google.com/search?igu=1&q=' + encodeURIComponent(url);
                }
            }
            
            browserUrl = url;
            document.getElementById('browserUrl').value = url.replace(/^https?:\/\//, '');
            
            const homepage = document.getElementById('browserHomepage');
            const loading = document.getElementById('browserLoading');
            const error = document.getElementById('browserError');
            const frame = document.getElementById('browserFrame');
            
            homepage.style.display = 'none';
            loading.classList.add('active');
            error.classList.remove('active');
            frame.classList.remove('active');
            
            document.getElementById('browserStatusText').textContent = 'Loading...';
            
            if (url.includes('google.com')) {
                if (!url.includes('igu=')) {
                    url += (url.includes('?') ? '&' : '?') + 'igu=1';
                }
                frame.src = url;
                
                // Use timeout to simulate load detection for embed
                setTimeout(() => {
                    loading.classList.remove('active');
                    frame.classList.add('active');
                    document.getElementById('browserStatusDot').classList.add('connected');
                    document.getElementById('browserStatusText').textContent = browserUrl;
                    
                    browserHistory = browserHistory.slice(0, browserHistoryIndex + 1);
                    browserHistory.push(browserUrl);
                    browserHistoryIndex = browserHistory.length - 1;
                    updateBrowserNav();
                }, 1500);
            } else {
                const proxyUrl = `https://corsproxy.io/?${encodeURIComponent(url)}`;
                
                fetch(proxyUrl)
                    .then(res => {
                        if (!res.ok) throw new Error(`HTTP ${res.status}`);
                        return res.text();
                    })
                    .then(html => {
                        html = html.replace(/<head(\s|>)/i, `<head$1<base href="${url}">`);
                        const blob = new Blob([html], { type: 'text/html' });
                        const blobUrl = URL.createObjectURL(blob);
                        frame.src = blobUrl;
                        
                        // Use timeout to simulate load detection for embed
                        setTimeout(() => {
                            loading.classList.remove('active');
                            frame.classList.add('active');
                            document.getElementById('browserStatusDot').classList.add('connected');
                            document.getElementById('browserStatusText').textContent = url;
                            
                            browserHistory = browserHistory.slice(0, browserHistoryIndex + 1);
                            browserHistory.push(url);
                            browserHistoryIndex = browserHistory.length - 1;
                            updateBrowserNav();
                        }, 1000);
                    })
                    .catch(err => {
                        loading.classList.remove('active');
                        error.classList.add('active');
                        try {
                            document.getElementById('browserErrorMsg').textContent = `Failed to load ${new URL(url).hostname}`;
                        } catch (e) {
                            document.getElementById('browserErrorMsg').textContent = `Failed to load page`;
                        }
                        document.getElementById('browserStatusDot').classList.remove('connected');
                        document.getElementById('browserStatusText').textContent = 'Error';
                    });
            }
        }

        function updateBrowserNav() {
            document.getElementById('browserBack').disabled = browserHistoryIndex <= 0;
            document.getElementById('browserForward').disabled = browserHistoryIndex >= browserHistory.length - 1;
        }

        function browserBack() {
            if (browserHistoryIndex > 0) {
                browserHistoryIndex--;
                browserNavigate(browserHistory[browserHistoryIndex]);
            }
        }

        function browserForward() {
            if (browserHistoryIndex < browserHistory.length - 1) {
                browserHistoryIndex++;
                browserNavigate(browserHistory[browserHistoryIndex]);
            }
        }

        // ==================== SETTINGS ====================
        function setTheme(theme) {
            currentTheme = theme;
            if (theme === 'light') {
                document.body.classList.add('light-theme');
            } else {
                document.body.classList.remove('light-theme');
            }
            document.querySelectorAll('.theme-option').forEach(opt => {
                opt.classList.toggle('active', opt.dataset.theme === theme);
            });
        }

        function setWallpaper(wallpaper) {
            currentWallpaper = wallpaper;
            const desktop = document.getElementById('desktop');
            desktop.className = 'desktop active ' + wallpaper;
            document.querySelectorAll('.wallpaper-option').forEach(opt => {
                opt.classList.toggle('active', opt.dataset.wallpaper === wallpaper);
            });
        }

        function changeWallpaper() {
            const wallpapers = ['default', 'wallpaper-1', 'wallpaper-2', 'wallpaper-3'];
            const currentIndex = wallpapers.indexOf(currentWallpaper);
            const nextIndex = (currentIndex + 1) % wallpapers.length;
            setWallpaper(wallpapers[nextIndex]);
            hideContextMenu();
        }

        // ==================== CONTEXT MENU ====================
        function showContextMenu(e) {
            e.preventDefault();
            const menu = document.getElementById('contextMenu');
            
            let x = e.clientX;
            let y = e.clientY;
            
            // Ensure menu stays within viewport
            const menuWidth = 200;
            const menuHeight = 250;
            
            if (x + menuWidth > window.innerWidth) {
                x = window.innerWidth - menuWidth - 10;
            }
            if (y + menuHeight > window.innerHeight) {
                y = window.innerHeight - menuHeight - 10;
            }
            
            menu.style.left = x + 'px';
            menu.style.top = y + 'px';
            menu.classList.add('active');
        }

        function hideContextMenu() {
            document.getElementById('contextMenu').classList.remove('active');
        }

        // ==================== EVENT LISTENERS ====================
        function initEventListeners() {
            // Startup icon
            document.getElementById('startupIcon').addEventListener('click', toggleLauncher);
            
            // Desktop icons - handle both double-click and touch
            document.querySelectorAll('.desktop-icon').forEach(icon => {
                let lastTap = 0;
                icon.addEventListener('touchend', (e) => {
                    const currentTime = new Date().getTime();
                    const tapLength = currentTime - lastTap;
                    if (tapLength < 300 && tapLength > 0) {
                        // Double tap detected
                        const appId = icon.getAttribute('ondblclick').match(/'([^']+)'/)[1];
                        openApp(appId);
                        e.preventDefault();
                    }
                    lastTap = currentTime;
                });
            });
            
            // Click outside to close launcher
            document.addEventListener('click', (e) => {
                const launcher = document.getElementById('appLauncher');
                const startupIcon = document.getElementById('startupIcon');
                if (!launcher.contains(e.target) && !startupIcon.contains(e.target)) {
                    closeLauncher();
                }
                hideContextMenu();
            });
            
            // Focus window on click
            document.querySelectorAll('.window').forEach(win => {
                win.addEventListener('mousedown', () => focusWindow(win.id));
                win.addEventListener('touchstart', () => focusWindow(win.id));
            });
            
            // Browser events
            document.getElementById('browserGo').addEventListener('click', () => browserNavigate());
            document.getElementById('browserUrl').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') browserNavigate();
            });
            document.getElementById('browserSearchBtn').addEventListener('click', () => {
                const query = document.getElementById('browserSearch').value;
                document.getElementById('browserUrl').value = query;
                browserNavigate(query);
            });
            document.getElementById('browserSearch').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const query = document.getElementById('browserSearch').value;
                    document.getElementById('browserUrl').value = query;
                    browserNavigate(query);
                }
            });
            document.getElementById('browserBack').addEventListener('click', browserBack);
            document.getElementById('browserForward').addEventListener('click', browserForward);
            document.getElementById('browserRefresh').addEventListener('click', () => {
                if (browserUrl) browserNavigate(browserUrl);
            });
            document.getElementById('browserRetry').addEventListener('click', () => {
                if (browserUrl) browserNavigate(browserUrl);
            });
            
            // Theme options
            document.querySelectorAll('.theme-option').forEach(opt => {
                opt.addEventListener('click', () => setTheme(opt.dataset.theme));
            });
            
            // Wallpaper options
            document.querySelectorAll('.wallpaper-option').forEach(opt => {
                opt.addEventListener('click', () => setWallpaper(opt.dataset.wallpaper));
            });
            
            // Toggle switches
            document.querySelectorAll('.toggle-switch').forEach(toggle => {
                toggle.addEventListener('click', () => toggle.classList.toggle('active'));
            });
            
            // Settings navigation
            document.querySelectorAll('.settings-nav-item').forEach(item => {
                item.addEventListener('click', () => {
                    document.querySelectorAll('.settings-nav-item').forEach(i => i.classList.remove('active'));
                    item.classList.add('active');
                });
            });
            
            // App launcher search
            document.getElementById('launcherSearch').addEventListener('input', (e) => {
                const query = e.target.value.toLowerCase();
                document.querySelectorAll('.launcher-app').forEach(app => {
                    const name = app.querySelector('span').textContent.toLowerCase();
                    app.style.display = name.includes(query) ? 'flex' : 'none';
                });
            });
            
            // Context menu
            document.getElementById('desktop').addEventListener('contextmenu', showContextMenu);
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeLauncher();
                    hideContextMenu();
                }
            });
        }
    </script>
</body>
</html>