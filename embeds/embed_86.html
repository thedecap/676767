<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Proton QR Decoder</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    :root {
        --purple-900: #1a0033;
        --purple-800: #2d0052;
        --purple-700: #4a0080;
        --purple-600: #6b21a8;
        --purple-500: #8b5cf6;
        --purple-400: #a78bfa;
        --purple-300: #c4b5fd;
        --purple-200: #e9d5ff;
        --purple-100: #f3e8ff;
        --black: #000000;
        --white: #ffffff;
    }

    body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        background: var(--black);
        color: var(--white);
        min-height: 100vh;
        position: relative;
        overflow-x: hidden;
    }

    /* Animated background */
    .background-gradient {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #000000 0%, #0a0015 50%, #000000 100%);
        z-index: 0;
    }

    .stars {
        position: fixed;
        width: 100%;
        height: 100%;
        background-image: 
            radial-gradient(2px 2px at 20px 30px, white, transparent),
            radial-gradient(2px 2px at 60px 70px, white, transparent),
            radial-gradient(1px 1px at 50px 50px, white, transparent),
            radial-gradient(1px 1px at 130px 80px, white, transparent),
            radial-gradient(2px 2px at 90px 150px, white, transparent);
        background-repeat: repeat;
        background-size: 200px 200px;
        opacity: 0.4;
        animation: starsMove 100s linear infinite;
        z-index: 1;
    }

    @keyframes starsMove {
        from { transform: translateY(0); }
        to { transform: translateY(-200px); }
    }

    /* Purple glow orbs */
    .orb {
        position: fixed;
        border-radius: 50%;
        filter: blur(60px);
        opacity: 0.1;
        z-index: 2;
        animation: float 20s ease-in-out infinite;
    }

    .orb-1 {
        width: 400px;
        height: 400px;
        background: radial-gradient(circle, var(--purple-600), transparent);
        top: -100px;
        left: -100px;
        animation-duration: 25s;
    }

    .orb-2 {
        width: 350px;
        height: 350px;
        background: radial-gradient(circle, var(--purple-700), transparent);
        bottom: -100px;
        right: -100px;
        animation-duration: 30s;
        animation-delay: -10s;
    }

    .orb-3 {
        width: 300px;
        height: 300px;
        background: radial-gradient(circle, var(--purple-500), transparent);
        top: 50%;
        left: 50%;
        animation-duration: 35s;
        animation-delay: -5s;
    }

    @keyframes float {
        0%, 100% { transform: translate(0, 0) scale(1); }
        33% { transform: translate(50px, -50px) scale(1.1); }
        66% { transform: translate(-50px, 50px) scale(0.9); }
    }

    /* Main container */
    .container {
        position: relative;
        z-index: 10;
        max-width: 800px;
        margin: 0 auto;
        padding: 2rem;
        min-height: 100vh;
        animation: fadeIn 1s ease-out;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }

    /* Header */
    .header {
        text-align: center;
        padding: 2rem 0;
    }

    /* Page title */
    .page-title {
        font-family: 'Space Grotesk', sans-serif;
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 1rem;
        letter-spacing: -0.02em;
        text-align: center;
    }

    .page-title .title-text {
        background: linear-gradient(135deg, var(--white) 0%, var(--purple-300) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .page-subtitle {
        font-size: 1.25rem;
        color: var(--purple-200);
        margin-bottom: 2rem;
        font-weight: 400;
        text-align: center;
        line-height: 1.7;
    }

    /* Divider */
    .divider {
        height: 1px;
        background: linear-gradient(90deg, transparent, var(--purple-500), transparent);
        margin: 2rem 0;
        opacity: 0.3;
    }

    /* Content card */
    .content-card {
        background: rgba(255, 255, 255, 0.03);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 1.5rem;
        padding: 2.5rem;
        box-shadow: 
            0 20px 50px rgba(0, 0, 0, 0.5),
            0 0 100px rgba(139, 92, 246, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.05);
        margin-bottom: 2rem;
    }

    /* Feature badges */
    .features {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        margin-bottom: 2rem;
    }

    .feature-badge {
        background: rgba(139, 92, 246, 0.1);
        border: 1px solid rgba(139, 92, 246, 0.2);
        padding: 0.5rem 1rem;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        color: var(--purple-200);
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .feature-icon {
        color: var(--purple-400);
    }

    /* Upload container */
    .upload-container {
        background: transparent;
        border-radius: 1rem;
        padding: 2rem;
    }

    /* Upload area */
    .upload-area {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 2rem;
        border: 2px dashed rgba(139, 92, 246, 0.4);
        border-radius: 1rem;
        cursor: pointer;
        transition: all 0.3s ease;
        background: rgba(0, 0, 0, 0.3);
        margin-bottom: 1.5rem;
    }

    .upload-area:hover {
        border-color: var(--purple-400);
        background: rgba(139, 92, 246, 0.1);
        transform: translateY(-2px);
    }

    .upload-area.dragover {
        border-color: var(--purple-400);
        background: rgba(139, 92, 246, 0.15);
        box-shadow: 0 0 30px rgba(139, 92, 246, 0.3);
    }

    .upload-icon {
        width: 64px;
        height: 64px;
        margin-bottom: 1rem;
        color: var(--purple-400);
        transition: all 0.3s ease;
    }

    .upload-area:hover .upload-icon {
        transform: scale(1.1) translateY(-5px);
        color: var(--purple-300);
    }

    .upload-text {
        font-size: 1.125rem;
        color: var(--purple-200);
        margin-bottom: 0.5rem;
        font-weight: 500;
    }

    .upload-hint {
        font-size: 0.875rem;
        color: var(--purple-300);
        opacity: 0.7;
    }

    #fileInput {
        display: none;
    }

    /* Preview and Results Layout */
    .preview-results {
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 1.5rem;
        align-items: start;
    }

    @media (max-width: 640px) {
        .preview-results {
            grid-template-columns: 1fr;
        }
    }

    /* Preview box */
    .preview-box {
        background: rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(139, 92, 246, 0.2);
        border-radius: 1rem;
        padding: 1rem;
        min-width: 180px;
        min-height: 180px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .preview-box img {
        max-width: 200px;
        max-height: 200px;
        border-radius: 0.5rem;
        display: block;
    }

    .preview-placeholder {
        color: var(--purple-300);
        opacity: 0.5;
        font-size: 0.9rem;
    }

    /* Results section */
    .results-section {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .input-label {
        display: block;
        font-size: 1rem;
        color: var(--purple-200);
        margin-bottom: 0.5rem;
        font-weight: 500;
    }

    textarea {
        width: 100%;
        background: rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(139, 92, 246, 0.3);
        border-radius: 0.75rem;
        padding: 1rem 1.25rem;
        color: var(--white);
        font-size: 1rem;
        font-family: 'JetBrains Mono', 'Courier New', monospace;
        transition: all 0.3s ease;
        min-height: 120px;
        resize: vertical;
        line-height: 1.5;
    }

    textarea:focus {
        outline: none;
        border-color: var(--purple-500);
        background: rgba(0, 0, 0, 0.7);
        box-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
    }

    textarea::placeholder {
        color: rgba(199, 210, 254, 0.5);
    }

    /* Link result */
    .link-result {
        display: none;
        align-items: center;
        gap: 0.75rem;
    }

    .link-result.show {
        display: flex;
    }

    .result-link {
        flex: 1;
        padding: 0.75rem 1rem;
        background: rgba(139, 92, 246, 0.15);
        border: 1px solid rgba(139, 92, 246, 0.3);
        border-radius: 0.5rem;
        color: var(--purple-200);
        text-decoration: none;
        font-weight: 500;
        word-break: break-all;
        transition: all 0.3s ease;
    }

    .result-link:hover {
        background: rgba(139, 92, 246, 0.25);
        color: var(--white);
    }

    /* Buttons */
    .action-buttons {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
    }

    .btn {
        flex: 1;
        min-width: 120px;
        padding: 0.875rem 1.5rem;
        background: linear-gradient(135deg, var(--purple-600), var(--purple-700));
        color: var(--white);
        border: none;
        border-radius: 0.75rem;
        font-size: 1rem;
        font-weight: 600;
        font-family: inherit;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
    }

    .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 30px rgba(139, 92, 246, 0.4);
    }

    .btn:active {
        transform: translateY(0);
    }

    .btn.secondary {
        background: rgba(139, 92, 246, 0.15);
        border: 1px solid rgba(139, 92, 246, 0.3);
    }

    .btn.secondary:hover {
        background: rgba(139, 92, 246, 0.25);
    }

    .btn.copy {
        flex: 0;
        min-width: auto;
        padding: 0.75rem 1rem;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .btn.copy:hover {
        background: rgba(255, 255, 255, 0.2);
    }

    /* Message */
    .message {
        font-size: 0.9rem;
        color: var(--purple-300);
        min-height: 1.5em;
        margin-top: 0.5rem;
    }

    .message.success {
        color: #6ee7b7;
    }

    .message.error {
        color: #f87171;
    }

    /* Info box */
    .info-box {
        background: rgba(139, 92, 246, 0.1);
        border: 1px solid rgba(139, 92, 246, 0.3);
        border-left: 4px solid var(--purple-500);
        border-radius: 1rem;
        padding: 1.5rem;
        margin-top: 1.5rem;
    }

    .info-box-title {
        font-family: 'Space Grotesk', sans-serif;
        font-size: 1.125rem;
        font-weight: 600;
        color: var(--white);
        margin-bottom: 0.75rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .info-text {
        font-size: 1rem;
        line-height: 1.7;
        color: var(--purple-200);
    }

    /* Footer */
    .footer {
        text-align: center;
        padding: 2rem 0;
        font-size: 0.9rem;
        color: var(--purple-300);
    }

    /* Responsive design */
    @media (max-width: 768px) {
        .container {
            padding: 1rem;
        }

        .content-card {
            padding: 1.5rem;
        }

        .page-title {
            font-size: 2rem;
        }

        .page-subtitle {
            font-size: 1rem;
        }

        .upload-container {
            padding: 1.5rem;
        }

        .upload-area {
            padding: 1.5rem;
        }

        .features {
            justify-content: center;
        }

        .preview-box {
            min-width: 100%;
        }

        .preview-box img {
            max-width: 100%;
        }
    }

    @media (max-width: 480px) {
        .page-title {
            font-size: 1.75rem;
        }

        .content-card {
            padding: 1.25rem;
        }

        .upload-container {
            padding: 1rem;
        }

        .upload-icon {
            width: 48px;
            height: 48px;
        }

        .action-buttons {
            flex-direction: column;
        }

        .btn {
            width: 100%;
        }
    }
</style>
</head>
<body>

<!-- Background elements -->
<div class="background-gradient"></div>
<div class="stars"></div>
<div class="orb orb-1"></div>
<div class="orb orb-2"></div>
<div class="orb orb-3"></div>

<!-- Main content -->
<div class="container">
    <header class="header">
        <h1 class="page-title"><span class="title-text">Proton QR Decoder</span> ðŸ“±</h1>
        <p class="page-subtitle">
            Upload a QR code image and instantly decode its contents
        </p>
    </header>

    <div class="divider"></div>

    <div class="content-card">

        <div class="upload-container" id="dropContainer">
            <div class="upload-area" id="uploadArea">
                <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"/>
                </svg>
                <span class="upload-text" id="fileName">Click or drag to upload QR image</span>
                <span class="upload-hint">Supports JPG, PNG, GIF, WebP</span>
            </div>

            <input type="file" id="fileInput" accept="image/*">

            <div class="preview-results">
                <div class="preview-box" id="previewBox">
                    <span class="preview-placeholder" id="previewText">No image</span>
                    <img id="previewImg" style="display:none;" alt="QR Preview">
                </div>

                <div class="results-section">
                    <div>
                        <label class="input-label">Decoded Output</label>
                        <textarea id="decodedText" placeholder="Decoded QR content will appear here..." readonly></textarea>
                    </div>

                    <div class="link-result" id="linkRow">
                        <a id="decodedLink" class="result-link" href="#" target="_blank" rel="noopener noreferrer">Open link</a>
                        <button class="btn copy" id="copyLinkBtn">
                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                            </svg>
                            Copy
                        </button>
                    </div>

                    <div class="action-buttons">
                        <button class="btn" id="decodeBtn">
                            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                            </svg>
                            Decode
                        </button>
                        <button class="btn secondary" id="clearBtn">
                            <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                            </svg>
                            Clear
                        </button>
                    </div>

                    <div class="message" id="message"></div>
                </div>
            </div>

            <div class="info-box">
                <div class="info-box-title">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>Quick Tips</span>
                </div>
                <p class="info-text">
                    You can also paste an image directly from your clipboard (Ctrl+V / Cmd+V). All processing happens locally in your browser â€” your images are never uploaded to any server.
                </p>
            </div>
        </div>
    </div>

    <div class="footer">Proton QR Decoder â€” upload an image and get a link/text instantly.</div>
</div>

<!-- jsQR library -->
<script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>

<script>
const fileInput = document.getElementById('fileInput');
const uploadArea = document.getElementById('uploadArea');
const fileName = document.getElementById('fileName');
const previewImg = document.getElementById('previewImg');
const previewBox = document.getElementById('previewBox');
const previewText = document.getElementById('previewText');
const decodedText = document.getElementById('decodedText');
const decodedLink = document.getElementById('decodedLink');
const linkRow = document.getElementById('linkRow');
const copyLinkBtn = document.getElementById('copyLinkBtn');
const decodeBtn = document.getElementById('decodeBtn');
const clearBtn = document.getElementById('clearBtn');
const message = document.getElementById('message');
const dropContainer = document.getElementById('dropContainer');
const canvas = document.createElement('canvas');
const ctx = canvas.getContext('2d');

function isProbablyURL(text) {
    try { new URL(text); return true; } catch(e){ return /^www\./i.test(text) || /^https?:\/\//i.test(text); }
}

function makeURL(text) { 
    try { return new URL(text).href; } catch(e){ return /^www\./i.test(text)?'http://'+text:text; } 
}

function showMessage(text, type = '') {
    message.textContent = text;
    message.className = 'message ' + type;
}

// Click to upload
uploadArea.addEventListener('click', () => fileInput.click());
fileInput.addEventListener('change', handleFileSelect);

// Drag and drop
uploadArea.addEventListener('dragover', e => { 
    e.preventDefault(); 
    uploadArea.classList.add('dragover'); 
});

uploadArea.addEventListener('dragleave', () => {
    uploadArea.classList.remove('dragover');
});

uploadArea.addEventListener('drop', e => {
    e.preventDefault();
    uploadArea.classList.remove('dragover');
    const f = e.dataTransfer.files && e.dataTransfer.files[0];
    if (!f) return;
    if (!f.type.startsWith('image/')) {
        showMessage('Please drop an image file.', 'error');
        return;
    }
    fileInput.files = e.dataTransfer.files;
    handleFileSelect();
});

function handleFileSelect() {
    const file = fileInput.files[0];
    if (!file) return;
    
    fileName.textContent = file.name;
    showMessage('');
    decodedText.value = '';
    linkRow.classList.remove('show');
    
    const reader = new FileReader();
    reader.onload = ev => {
        const img = new Image();
        img.onload = () => {
            previewImg.src = img.src;
            previewImg.style.display = 'block';
            previewText.style.display = 'none';
        };
        img.onerror = () => {
            previewText.textContent = 'Unable to load image';
            previewText.style.display = 'block';
            previewImg.style.display = 'none';
        };
        img.src = ev.target.result;
    };
    reader.readAsDataURL(file);
}

function decodeCurrentImage() {
    const src = previewImg.src;
    if (!src) {
        showMessage('No image loaded.', 'error');
        return;
    }
    
    const img = new Image();
    img.onload = () => {
        const maxDim = 1600;
        let w = img.naturalWidth, h = img.naturalHeight;
        let scale = 1;
        
        if (w > maxDim || h > maxDim) {
            scale = Math.min(maxDim / w, maxDim / h);
            w = Math.round(w * scale);
            h = Math.round(h * scale);
        }
        
        canvas.width = w;
        canvas.height = h;
        ctx.clearRect(0, 0, w, h);
        ctx.drawImage(img, 0, 0, w, h);
        
        try {
            const imageData = ctx.getImageData(0, 0, w, h);
            const code = jsQR(imageData.data, imageData.width, imageData.height, { inversionAttempts: "attemptBoth" });
            
            if (code && code.data) {
                decodedText.value = code.data;
                showMessage('QR decoded successfully!', 'success');
                
                if (isProbablyURL(code.data)) {
                    decodedLink.href = makeURL(code.data);
                    decodedLink.textContent = decodedLink.href;
                    linkRow.classList.add('show');
                } else {
                    linkRow.classList.remove('show');
                }
            } else {
                decodedText.value = '';
                linkRow.classList.remove('show');
                showMessage('No QR found or unreadable. Try a clearer image.', 'error');
            }
        } catch (err) {
            decodedText.value = '';
            linkRow.classList.remove('show');
            showMessage('Error decoding image: ' + err.message, 'error');
        }
    };
    img.onerror = () => {
        showMessage('Failed to load preview image.', 'error');
    };
    img.src = src;
}

decodeBtn.addEventListener('click', decodeCurrentImage);

copyLinkBtn.addEventListener('click', async () => {
    const text = decodedLink.href || decodedText.value;
    if (!text) return;
    
    try {
        await navigator.clipboard.writeText(text);
        showMessage('Copied to clipboard!', 'success');
    } catch {
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        try {
            document.execCommand('copy');
            showMessage('Copied to clipboard!', 'success');
        } catch {
            showMessage('Copy failed. Please copy manually.', 'error');
        }
        ta.remove();
    }
});

clearBtn.addEventListener('click', () => {
    fileInput.value = '';
    fileName.textContent = 'Click or drag to upload QR image';
    previewImg.src = '';
    previewImg.style.display = 'none';
    previewText.style.display = 'block';
    previewText.textContent = 'No image';
    decodedText.value = '';
    linkRow.classList.remove('show');
    showMessage('');
});

// Auto-decode on image load
previewImg.addEventListener('load', () => {
    setTimeout(() => decodeCurrentImage(), 180);
});

// Paste support
window.addEventListener('paste', e => {
    const items = e.clipboardData && e.clipboardData.items;
    if (!items) return;
    
    for (const it of items) {
        if (it.type && it.type.startsWith('image/')) {
            const blob = it.getAsFile();
            if (!blob) continue;
            
            const f = new File([blob], 'pasted-image.png', { type: blob.type });
            const dataTransfer = new DataTransfer();
            dataTransfer.items.add(f);
            fileInput.files = dataTransfer.files;
            handleFileSelect();
            break;
        }
    }
});
</script>
</body>
</html>